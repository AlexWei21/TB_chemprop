                                                                                                                       Loss = 3.9459e-01, PNorm = 34.0258, GNorm = 0.6065, lr_0 = 4.3000e-04
 50%|█████████████████████████████████████████▌                                         | 8/16 [00:00<00:00, 14.82it/s]Validation auc = 0.513587
Epoch 1
                                                                                                                       Loss = 2.4347e-01, PNorm = 34.0446, GNorm = 0.1529, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.19it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.05it/s]Validation auc = 0.796196
Epoch 2
                                                                                                                       Loss = 2.6231e-01, PNorm = 34.0984, GNorm = 0.5433, lr_0 = 9.3633e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.54it/s]Validation auc = 0.834239
Epoch 3
                                                                                                                       Loss = 3.1544e-01, PNorm = 34.1215, GNorm = 0.2302, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.3546e-01, PNorm = 34.1452, GNorm = 0.4069, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.71it/s]Validation auc = 0.845109
Epoch 4
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.70it/s]Validation auc = 0.851902
Epoch 5
                                                                                                                       Loss = 2.3171e-01, PNorm = 34.2040, GNorm = 0.2466, lr_0 = 7.5195e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.3814e-01, PNorm = 34.2315, GNorm = 0.2283, lr_0 = 7.1184e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 20.86it/s]Validation auc = 0.853261
Epoch 6
                                                                                                                       Loss = 2.2341e-01, PNorm = 34.2645, GNorm = 0.2499, lr_0 = 6.7386e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.30it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.29it/s]Validation auc = 0.860054
Epoch 7
                                                                                                                       Loss = 2.0298e-01, PNorm = 34.3417, GNorm = 0.1038, lr_0 = 6.0388e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.64it/s]Validation auc = 0.875000
Epoch 8
                                                                                                                       Loss = 1.7690e-01, PNorm = 34.3799, GNorm = 0.3622, lr_0 = 5.7167e-04
 12%|██████████▍                                                                        | 2/16 [00:00<00:00, 19.94it/s]Loss = 2.3264e-01, PNorm = 34.4364, GNorm = 0.6819, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 19.09it/s]
Epoch 9
                                                                                                                       Loss = 2.1848e-01, PNorm = 34.4777, GNorm = 0.2497, lr_0 = 5.1230e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 19.85it/s]Validation auc = 0.883152
Epoch 10
                                                                                                                       Loss = 1.1981e-01, PNorm = 34.5328, GNorm = 0.1419, lr_0 = 4.8497e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0799e-01, PNorm = 34.5691, GNorm = 0.1998, lr_0 = 4.5910e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 19.64it/s]Validation auc = 0.884511
Epoch 11
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.11it/s]Loss = 1.9651e-01, PNorm = 34.6677, GNorm = 0.2581, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.57it/s]Validation auc = 0.881793
Epoch 12
                                                                                                                       Loss = 1.7990e-01, PNorm = 34.7168, GNorm = 0.6733, lr_0 = 3.8947e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 24.11it/s]Validation auc = 0.891304
Epoch 13
                                                                                                                       Loss = 1.6983e-01, PNorm = 34.7566, GNorm = 0.2202, lr_0 = 3.6869e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.88it/s]Validation auc = 0.899457
Epoch 14
                                                                                                                       Loss = 1.8821e-01, PNorm = 34.8420, GNorm = 0.4895, lr_0 = 3.3041e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.53it/s]Validation auc = 0.900815
Epoch 15
                                                                                                                       Loss = 1.7772e-01, PNorm = 34.8801, GNorm = 0.5062, lr_0 = 3.1278e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.7441e-01, PNorm = 34.9139, GNorm = 0.8095, lr_0 = 2.9609e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.08it/s]Validation auc = 0.914402
Epoch 16
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.40it/s]Loss = 1.8096e-01, PNorm = 34.9841, GNorm = 1.6034, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.91it/s]Validation auc = 0.911685
Epoch 17
                                                                                                                       Loss = 1.5766e-01, PNorm = 35.0181, GNorm = 1.4874, lr_0 = 2.5119e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.69it/s]Validation auc = 0.915761
Epoch 18
                                                                                                                       Loss = 2.0607e-01, PNorm = 35.0560, GNorm = 1.3309, lr_0 = 2.3779e-04
 12%|██████████▍                                                                        | 2/16 [00:00<00:00, 19.47it/s]
 62%|███████████████████████████████████████████████████▎                              | 10/16 [00:00<00:00, 21.09it/s]Validation auc = 0.914402
Epoch 19
                                                                                                                       Loss = 1.4891e-01, PNorm = 35.1073, GNorm = 0.8884, lr_0 = 2.1309e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.07it/s]Validation auc = 0.915761
Epoch 20
                                                                                                                       Loss = 5.4148e-02, PNorm = 35.1295, GNorm = 0.5630, lr_0 = 2.0173e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5943e-01, PNorm = 35.1551, GNorm = 0.6799, lr_0 = 1.9096e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 23.13it/s]Validation auc = 0.922554
Epoch 21
                                                                                                                       Loss = 1.5626e-01, PNorm = 35.1763, GNorm = 0.7849, lr_0 = 1.8078e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.07it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.30it/s]Validation auc = 0.917120
Epoch 22
                                                                                                                       Loss = 1.5394e-01, PNorm = 35.2237, GNorm = 1.9709, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.50it/s]Validation auc = 0.917120
Epoch 23
                                                                                                                       Loss = 1.1876e-01, PNorm = 35.2396, GNorm = 0.4095, lr_0 = 1.5336e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.4846e-01, PNorm = 35.2593, GNorm = 2.5162, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.55it/s]Validation auc = 0.918478
Epoch 24
                                                                                                                       Loss = 1.3907e-01, PNorm = 35.2762, GNorm = 0.4161, lr_0 = 1.3743e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.52it/s]Validation auc = 0.918478
Epoch 25
                                                                                                                       Loss = 1.0181e-01, PNorm = 35.2921, GNorm = 0.6120, lr_0 = 1.3010e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.1986e-01, PNorm = 35.3095, GNorm = 0.5498, lr_0 = 1.2316e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.79it/s]Validation auc = 0.919837
Epoch 26
                                                                                                                       Loss = 1.3639e-01, PNorm = 35.3235, GNorm = 0.6446, lr_0 = 1.1659e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.47it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.35it/s]Validation auc = 0.917120
Epoch 27
                                                                                                                       Loss = 1.1792e-01, PNorm = 35.3540, GNorm = 1.0946, lr_0 = 1.0448e-04
 50%|█████████████████████████████████████████▌                                         | 8/16 [00:00<00:00, 20.59it/s]Validation auc = 0.918478
Epoch 28
                                                                                                                       Loss = 1.1048e-01, PNorm = 35.3679, GNorm = 0.4937, lr_0 = 1.0000e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.2934e-01, PNorm = 35.3785, GNorm = 0.8774, lr_0 = 1.0000e-04
 62%|███████████████████████████████████████████████████▎                              | 10/16 [00:00<00:00, 19.16it/s]Validation auc = 0.921196
Epoch 29
Loading pretrained parameter "encoder.encoder.0.W_o.bias".                              | 6/16 [00:00<00:00, 23.07it/s]Validation auc = 0.921196
Model 0 best validation auc = 0.922554 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".                              | 6/16 [00:00<00:00, 23.07it/s]Validation auc = 0.921196
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.920962
Ensemble test auc = 0.920962
Fold 1
Splitting data with seed 1
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                           | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                       Loss = 4.0233e-01, PNorm = 34.0252, GNorm = 0.5390, lr_0 = 4.3000e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.62it/s]Validation auc = 0.450077
  3%|██▊                                                                                | 1/30 [00:00<00:23,  1.22it/s]Epoch 1
                                                                                                                       Loss = 1.4296e-01, PNorm = 34.0476, GNorm = 0.4083, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.52it/s]Loss = 2.6266e-01, PNorm = 34.0790, GNorm = 0.2813, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.55it/s]Validation auc = 0.589862
  7%|█████▌                                                                             | 2/30 [00:01<00:24,  1.14it/s]Epoch 2
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.07it/s]
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.52it/s]Loss = 2.6266e-01, PNorm = 34.0790, GNorm = 0.2813, lr_0 = 9.8910e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.52it/s]Loss = 2.6266e-01, PNorm = 34.0790, GNorm = 0.2813, lr_0 = 9.8910e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.35it/s]Validation auc = 0.600614= 34.0790, GNorm = 0.2813, lr_0 = 9.8910e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5870e-01, PNorm = 34.7304, GNorm = 0.4493, lr_0 = 2.9609e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.81it/s]Validation auc = 0.688172= 34.7304, GNorm = 0.4493, lr_0 = 2.9609e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.8409e-01, PNorm = 34.9392, GNorm = 0.5946, lr_0 = 1.9096e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.09it/s]Validation auc = 0.751152= 34.9392, GNorm = 0.5946, lr_0 = 1.9096e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.6097e-01, PNorm = 35.0836, GNorm = 1.2136, lr_0 = 1.2316e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5957e-01, PNorm = 35.1362, GNorm = 0.8120, lr_0 = 1.0000e-04
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".                            | 0/16 [00:00<?, ?it/s]Loss = 1.5957e-01, PNorm = 35.1362, GNorm = 0.8120, lr_0 = 1.0000e-04
  7%|█████▌                                                                             | 2/30 [00:01<00:22,  1.23it/s]Epoch 21.5957e-01, PNorm = 35.1362, GNorm = 0.8120, lr_0 = 1.0000e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.6348e-01, PNorm = 34.2327, GNorm = 0.0838, lr_0 = 7.1184e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.45it/s]Validation auc = 0.800687= 34.2327, GNorm = 0.0838, lr_0 = 7.1184e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0087e-01, PNorm = 34.5228, GNorm = 1.1308, lr_0 = 4.5910e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.06it/s]Validation auc = 0.907216= 34.5228, GNorm = 1.1308, lr_0 = 4.5910e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.9423e-01, PNorm = 34.7763, GNorm = 2.1392, lr_0 = 2.9609e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.58it/s]Validation auc = 0.920962= 34.7763, GNorm = 2.1392, lr_0 = 2.9609e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Validation auc = 0.920962= 34.7763, GNorm = 2.1392, lr_0 = 2.9609e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.6520e-01, PNorm = 35.0377, GNorm = 0.3890, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.09it/s]Validation auc = 0.903780= 35.0377, GNorm = 0.3890, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.09it/s]Loss = 1.5126e-01, PNorm = 35.1446, GNorm = 0.8043, lr_0 = 1.0448e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.99it/s]Validation auc = 0.914089= 35.1446, GNorm = 0.8043, lr_0 = 1.0448e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.99it/s]Loss = 2.1289e-01, PNorm = 34.0434, GNorm = 0.3594, lr_0 = 7.6000e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.90it/s]Validation auc = 0.754579= 34.0434, GNorm = 0.3594, lr_0 = 7.6000e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.90it/s]Loss = 2.2204e-01, PNorm = 34.2617, GNorm = 0.2830, lr_0 = 6.0388e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.26it/s]Validation auc = 0.752137= 34.2617, GNorm = 0.2830, lr_0 = 6.0388e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.26it/s]Loss = 1.7648e-01, PNorm = 34.4932, GNorm = 0.4004, lr_0 = 3.8947e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.26it/s]Loss = 5.7955e-02, PNorm = 34.6156, GNorm = 0.1842, lr_0 = 3.1278e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.26it/s]Loss = 2.0242e-01, PNorm = 34.7120, GNorm = 0.5976, lr_0 = 2.5119e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.26it/s]Loss = 1.9164e-01, PNorm = 34.8037, GNorm = 0.3816, lr_0 = 2.0173e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.04it/s]Validation auc = 0.777778= 34.8037, GNorm = 0.3816, lr_0 = 2.0173e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.3086e-01, PNorm = 34.9527, GNorm = 1.0277, lr_0 = 1.2316e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.33it/s]Validation auc = 0.789988= 34.9527, GNorm = 1.0277, lr_0 = 1.2316e-04
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".                    | 6/16 [00:00<00:00, 23.33it/s]Validation auc = 0.789988= 34.9527, GNorm = 1.0277, lr_0 = 1.2316e-04
  7%|█████▌                                                                             | 2/30 [00:01<00:23,  1.19it/s]Epoch 2ion auc = 0.789988= 34.9527, GNorm = 1.0277, lr_0 = 1.2316e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.59it/s]Validation auc = 0.736264= 34.9527, GNorm = 1.0277, lr_0 = 1.2316e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.61it/s]Validation auc = 0.750916= 34.9527, GNorm = 1.0277, lr_0 = 1.2316e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.61it/s]Loss = 1.8663e-01, PNorm = 34.4270, GNorm = 0.2328, lr_0 = 5.1230e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.01it/s]Loss = 1.6066e-01, PNorm = 34.6054, GNorm = 0.5042, lr_0 = 4.1142e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.01it/s]Loss = 1.8271e-01, PNorm = 34.7604, GNorm = 1.2594, lr_0 = 3.3041e-04
 57%|██████████████████████████████████████████████▍                                   | 17/30 [00:13<00:10,  1.27it/s]Epoch 17.8271e-01, PNorm = 34.7604, GNorm = 1.2594, lr_0 = 3.3041e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.68it/s]Validation auc = 0.794872= 34.7604, GNorm = 1.2594, lr_0 = 3.3041e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.68it/s]Loss = 1.5284e-01, PNorm = 35.0899, GNorm = 0.6826, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 15.00it/s]Validation auc = 0.788767= 35.0899, GNorm = 0.6826, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 15.00it/s]Validation auc = 0.788767= 35.0899, GNorm = 0.6826, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 15.00it/s]Loss = 1.4278e-01, PNorm = 35.2522, GNorm = 0.3986, lr_0 = 1.0000e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 15.00it/s]Loss = 1.4278e-01, PNorm = 35.2522, GNorm = 0.3986, lr_0 = 1.0000e-04