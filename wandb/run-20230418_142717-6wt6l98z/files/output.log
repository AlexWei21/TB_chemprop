Fold 3
Splitting data with seed 3
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                           | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                       Loss = 4.0001e-01, PNorm = 34.0252, GNorm = 0.6016, lr_0 = 4.3000e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 23.34it/s]Validation auc = 0.538462
  3%|██▊                                                                                | 1/30 [00:00<00:22,  1.28it/s]Epoch 1
                                                                                                                       Loss = 2.1289e-01, PNorm = 34.0434, GNorm = 0.3594, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 20.76it/s]Loss = 2.4657e-01, PNorm = 34.0821, GNorm = 0.2382, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.55it/s]Validation auc = 0.748474
  7%|█████▌                                                                             | 2/30 [00:01<00:22,  1.27it/s]Epoch 2
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.52it/s]Validation auc = 0.708181
 10%|████████▎                                                                          | 3/30 [00:02<00:21,  1.28it/s]Epoch 3
                                                                                                                       Loss = 2.5489e-01, PNorm = 34.1134, GNorm = 0.1967, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0334e-01, PNorm = 34.1259, GNorm = 0.0846, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.42it/s]Validation auc = 0.755800
 13%|███████████                                                                        | 4/30 [00:03<00:20,  1.28it/s]Epoch 4
                                                                                                                       Loss = 2.1503e-01, PNorm = 34.1434, GNorm = 0.3731, lr_0 = 7.9433e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.43it/s]
 17%|█████████████▊                                                                     | 5/30 [00:03<00:19,  1.29it/s]Epoch 5
                                                                                                                       Loss = 2.3644e-01, PNorm = 34.1645, GNorm = 0.2826, lr_0 = 7.5195e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.7781e-01, PNorm = 34.1845, GNorm = 0.1809, lr_0 = 7.1184e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 23.67it/s]Validation auc = 0.770452
 20%|████████████████▌                                                                  | 6/30 [00:04<00:18,  1.29it/s]Epoch 6
                                                                                                                       Loss = 2.1811e-01, PNorm = 34.2070, GNorm = 0.5345, lr_0 = 6.7386e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.52it/s]Loss = 2.1865e-01, PNorm = 34.2402, GNorm = 0.5188, lr_0 = 6.3791e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.21it/s]Validation auc = 0.759463
 23%|███████████████████▎                                                               | 7/30 [00:05<00:17,  1.31it/s]Epoch 7
                                                                                                                       Loss = 2.2202e-01, PNorm = 34.2616, GNorm = 0.2887, lr_0 = 6.0388e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.25it/s]
 27%|██████████████████████▏                                                            | 8/30 [00:06<00:16,  1.31it/s]Epoch 8
                                                                                                                       Loss = 1.5246e-01, PNorm = 34.2982, GNorm = 0.4312, lr_0 = 5.7167e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0653e-01, PNorm = 34.3239, GNorm = 0.4796, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.93it/s]Validation auc = 0.759463
 30%|████████████████████████▉                                                          | 9/30 [00:06<00:16,  1.30it/s]Epoch 9
                                                                                                                       Loss = 1.9920e-01, PNorm = 34.3556, GNorm = 0.7831, lr_0 = 5.1230e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.14it/s]
 33%|███████████████████████████▎                                                      | 10/30 [00:07<00:16,  1.22it/s]Epoch 10
                                                                                                                       Loss = 1.4811e-01, PNorm = 34.3829, GNorm = 0.1853, lr_0 = 4.8497e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.9931e-01, PNorm = 34.4173, GNorm = 0.1334, lr_0 = 4.5910e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.99it/s]Validation auc = 0.741148
 37%|██████████████████████████████                                                    | 11/30 [00:08<00:15,  1.23it/s]Epoch 11
                                                                                                                       Loss = 2.1648e-01, PNorm = 34.4426, GNorm = 0.4681, lr_0 = 4.3461e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 21.77it/s]Loss = 1.8617e-01, PNorm = 34.4818, GNorm = 0.3870, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.91it/s]Validation auc = 0.731380
 40%|████████████████████████████████▊                                                 | 12/30 [00:09<00:14,  1.24it/s]Epoch 12
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.07it/s]Validation auc = 0.759463
 43%|███████████████████████████████████▌                                              | 13/30 [00:10<00:13,  1.25it/s]Epoch 13
                                                                                                                       Loss = 1.0954e-01, PNorm = 34.5337, GNorm = 0.1397, lr_0 = 3.6869e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.8905e-01, PNorm = 34.5513, GNorm = 0.2492, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.67it/s]Validation auc = 0.749695
 47%|██████████████████████████████████████▎                                           | 14/30 [00:11<00:12,  1.28it/s]Epoch 14
                                                                                                                       Loss = 2.1370e-01, PNorm = 34.5808, GNorm = 0.2129, lr_0 = 3.3041e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.20it/s]Validation auc = 0.728938
 50%|█████████████████████████████████████████                                         | 15/30 [00:11<00:11,  1.29it/s]Epoch 15
                                                                                                                       Loss = 5.8710e-02, PNorm = 34.6190, GNorm = 0.1869, lr_0 = 3.1278e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.89it/s]Validation auc = 0.755800
 53%|███████████████████████████████████████████▋                                      | 16/30 [00:12<00:10,  1.30it/s]Epoch 16
                                                                                                                       Loss = 1.9405e-01, PNorm = 34.6694, GNorm = 0.2247, lr_0 = 2.8030e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 24.17it/s]Loss = 1.6455e-01, PNorm = 34.6896, GNorm = 0.1993, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.01it/s]Validation auc = 0.753358
 57%|██████████████████████████████████████████████▍                                   | 17/30 [00:13<00:09,  1.31it/s]Epoch 17
                                                                                                                       Loss = 2.0187e-01, PNorm = 34.7188, GNorm = 0.6376, lr_0 = 2.5119e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.83it/s]
 60%|█████████████████████████████████████████████████▏                                | 18/30 [00:14<00:09,  1.31it/s]Epoch 18
                                                                                                                       Loss = 1.6957e-01, PNorm = 34.7452, GNorm = 0.4529, lr_0 = 2.3779e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.7873e-01, PNorm = 34.7684, GNorm = 0.3967, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.05it/s]Validation auc = 0.764347
 63%|███████████████████████████████████████████████████▉                              | 19/30 [00:14<00:08,  1.32it/s]Epoch 19
                                                                                                                       Loss = 1.8458e-01, PNorm = 34.7899, GNorm = 0.5075, lr_0 = 2.1309e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.70it/s]Validation auc = 0.761905
 67%|██████████████████████████████████████████████████████▋                           | 20/30 [00:15<00:07,  1.32it/s]Epoch 20
                                                                                                                       Loss = 1.9259e-01, PNorm = 34.8137, GNorm = 0.3952, lr_0 = 2.0173e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.4713e-01, PNorm = 34.8332, GNorm = 0.7313, lr_0 = 1.9096e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.40it/s]Loss = 1.6123e-01, PNorm = 34.8804, GNorm = 0.6323, lr_0 = 1.7113e-04
 70%|█████████████████████████████████████████████████████████▍                        | 21/30 [00:16<00:06,  1.32it/s]Epoch 21
                                                                                                                       Loss = 1.8258e-01, PNorm = 34.8517, GNorm = 1.2998, lr_0 = 1.8078e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.40it/s]Loss = 1.6123e-01, PNorm = 34.8804, GNorm = 0.6323, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.59it/s]Validation auc = 0.774115
 73%|████████████████████████████████████████████████████████████▏                     | 22/30 [00:17<00:06,  1.31it/s]Epoch 22
                                                                                                                       Loss = 1.6931e-01, PNorm = 34.8912, GNorm = 0.6256, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.28it/s]Validation auc = 0.775336
 77%|██████████████████████████████████████████████████████████████▊                   | 23/30 [00:17<00:05,  1.28it/s]Epoch 23
                                                                                                                       Loss = 1.0606e-01, PNorm = 34.9194, GNorm = 0.4713, lr_0 = 1.5336e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.99it/s]Validation auc = 0.776557
 80%|█████████████████████████████████████████████████████████████████▌                | 24/30 [00:18<00:04,  1.26it/s]Epoch 24
                                                                                                                       Loss = 1.5172e-01, PNorm = 34.9455, GNorm = 0.5785, lr_0 = 1.3743e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.77it/s]Validation auc = 0.789988
 83%|████████████████████████████████████████████████████████████████████▎             | 25/30 [00:19<00:04,  1.24it/s]Epoch 25
                                                                                                                       Loss = 1.3820e-01, PNorm = 34.9547, GNorm = 0.1979, lr_0 = 1.3010e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.3081e-01, PNorm = 34.9677, GNorm = 1.0392, lr_0 = 1.2316e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.53it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.80it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.47it/s]Validation auc = 0.777778
 90%|█████████████████████████████████████████████████████████████████████████▊        | 27/30 [00:21<00:02,  1.27it/s]Epoch 27
                                                                                                                       Loss = 1.4171e-01, PNorm = 35.0067, GNorm = 0.3005, lr_0 = 1.0448e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.69it/s]Validation auc = 0.788767
 93%|████████████████████████████████████████████████████████████████████████████▌     | 28/30 [00:21<00:01,  1.29it/s]Epoch 28
                                                                                                                       Loss = 1.7813e-01, PNorm = 35.0175, GNorm = 0.4920, lr_0 = 1.0000e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.48it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.47it/s]Validation auc = 0.777778
Model 0 test auc = 0.864823                                                                                            Validation auc = 0.777778
Ensemble test auc = 0.864823
Model 0 test auc = 0.864823                                                                                            Validation auc = 0.777778