Fold 0
Splitting data with seed 0
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                      | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                  Loss = 3.9459e-01, PNorm = 34.0258, GNorm = 0.6065, lr_0 = 4.3000e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 14.08it/s]Validation auc = 0.513587
Validation binary_cross_entropy = 0.304513
  3%|███▋                                                                                                          | 1/30 [00:01<00:34,  1.20s/it]Epoch 1
                                                                                                                                                  Loss = 2.4347e-01, PNorm = 34.0446, GNorm = 0.1529, lr_0 = 7.6000e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 20.93it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 20.73it/s]
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.93it/s]Validation auc = 0.796196
Validation binary_cross_entropy = 0.263099
  7%|███████▎                                                                                                      | 2/30 [00:02<00:28,  1.00s/it]Epoch 2
                                                                                                                                                  Loss = 2.6231e-01, PNorm = 34.0984, GNorm = 0.5433, lr_0 = 9.3633e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 18.27it/s]Validation auc = 0.834239
Validation binary_cross_entropy = 0.265333
 10%|███████████                                                                                                   | 3/30 [00:03<00:26,  1.01it/s]Epoch 3
                                                                                                                                                  Loss = 3.1544e-01, PNorm = 34.1215, GNorm = 0.2302, lr_0 = 8.8638e-04
 12%|█████████████▊                                                                                                | 2/16 [00:00<00:00, 16.09it/s]Loss = 2.3546e-01, PNorm = 34.1452, GNorm = 0.4069, lr_0 = 8.3909e-04
 62%|████████████████████████████████████████████████████████████████████▏                                        | 10/16 [00:00<00:00, 19.17it/s]
 81%|████████████████████████████████████████████████████████████████████████████████████████▌                    | 13/16 [00:00<00:00, 19.88it/s]
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.265147
 13%|██████████████▋                                                                                               | 4/30 [00:03<00:24,  1.04it/s]Epoch 4
                                                                                                                                                  Loss = 2.6997e-01, PNorm = 34.1644, GNorm = 0.3173, lr_0 = 7.9433e-04
 31%|██████████████████████████████████▍                                                                           | 5/16 [00:00<00:00, 19.24it/s]Validation auc = 0.851902
Validation binary_cross_entropy = 0.244183
 17%|██████████████████▎                                                                                           | 5/30 [00:04<00:23,  1.08it/s]Epoch 5
                                                                                                                                                  Loss = 2.3171e-01, PNorm = 34.2040, GNorm = 0.2467, lr_0 = 7.5195e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.3814e-01, PNorm = 34.2315, GNorm = 0.2276, lr_0 = 7.1184e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 19.92it/s]Validation auc = 0.853261
Validation binary_cross_entropy = 0.247416
 20%|██████████████████████                                                                                        | 6/30 [00:05<00:21,  1.10it/s]Epoch 6
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 21.59it/s]Loss = 2.0468e-01, PNorm = 34.3004, GNorm = 0.1226, lr_0 = 6.3791e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.61it/s]Validation auc = 0.858696
Validation binary_cross_entropy = 0.237346
 23%|█████████████████████████▋                                                                                    | 7/30 [00:06<00:20,  1.12it/s]Epoch 7
                                                                                                                                                  Loss = 2.0301e-01, PNorm = 34.3419, GNorm = 0.1077, lr_0 = 6.0388e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.80it/s]Validation auc = 0.875000
Validation binary_cross_entropy = 0.231868
 27%|█████████████████████████████▎                                                                                | 8/30 [00:07<00:18,  1.16it/s]Epoch 8
                                                                                                                                                  Loss = 1.7613e-01, PNorm = 34.3797, GNorm = 0.3529, lr_0 = 5.7167e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.67it/s]
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.12it/s]Validation auc = 0.873641
Validation binary_cross_entropy = 0.232527
 30%|█████████████████████████████████                                                                             | 9/30 [00:08<00:17,  1.20it/s]Epoch 9
                                                                                                                                                  Loss = 2.1813e-01, PNorm = 34.4757, GNorm = 0.2505, lr_0 = 5.1230e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.74it/s]Validation auc = 0.879076
Validation binary_cross_entropy = 0.229846
 33%|████████████████████████████████████▎                                                                        | 10/30 [00:09<00:17,  1.17it/s]Epoch 10
                                                                                                                                                  Loss = 1.1982e-01, PNorm = 34.5296, GNorm = 0.1424, lr_0 = 4.8497e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0801e-01, PNorm = 34.5656, GNorm = 0.2028, lr_0 = 4.5910e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 21.54it/s]Validation auc = 0.883152
Validation binary_cross_entropy = 0.221648
 37%|███████████████████████████████████████▉                                                                     | 11/30 [00:09<00:16,  1.17it/s]Epoch 11
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 25%|███████████████████████████▌                                                                                  | 4/16 [00:00<00:00, 18.59it/s]Loss = 1.9626e-01, PNorm = 34.6624, GNorm = 0.2604, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.40it/s]Validation auc = 0.884511
Validation binary_cross_entropy = 0.216851
 40%|███████████████████████████████████████████▌                                                                 | 12/30 [00:10<00:15,  1.16it/s]Epoch 12
                                                                                                                                                  Loss = 1.7958e-01, PNorm = 34.7115, GNorm = 0.6964, lr_0 = 3.8947e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.77it/s]Validation auc = 0.889946
Validation binary_cross_entropy = 0.206599
 43%|███████████████████████████████████████████████▏                                                             | 13/30 [00:11<00:14,  1.16it/s]Epoch 13
                                                                                                                                                  Loss = 1.6977e-01, PNorm = 34.7512, GNorm = 0.2355, lr_0 = 3.6869e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 20.49it/s]
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.13it/s]Validation auc = 0.899457
Validation binary_cross_entropy = 0.207468
 47%|██████████████████████████████████████████████████▊                                                          | 14/30 [00:12<00:13,  1.16it/s]Epoch 14
                                                                                                                                                  Loss = 1.8838e-01, PNorm = 34.8347, GNorm = 0.5011, lr_0 = 3.3041e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 20.57it/s]Validation auc = 0.900815
Validation binary_cross_entropy = 0.210668
 50%|██████████████████████████████████████████████████████▌                                                      | 15/30 [00:13<00:13,  1.15it/s]Epoch 15
                                                                                                                                                  Loss = 1.7691e-01, PNorm = 34.8728, GNorm = 0.5280, lr_0 = 3.1278e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7376e-01, PNorm = 34.9060, GNorm = 0.8134, lr_0 = 2.9609e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.81it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.60it/s]
auc
binary_cross_entropy
auc
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:14<00:12,  1.15it/s]Epoch 16
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:14<00:12,  1.15it/s]Epoch 16
                                                                                                                                                  Loss = 1.3588e-01, PNorm = 34.9420, GNorm = 0.5128, lr_0 = 2.8030e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 20.83it/s]Loss = 1.8027e-01, PNorm = 34.9738, GNorm = 1.6386, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.48it/s]Validation auc = 0.911685
Validation binary_cross_entropy = 0.191095
 57%|█████████████████████████████████████████████████████████████▊                                               | 17/30 [00:15<00:11,  1.18it/s]Epoch 17
                                                                                                                                                  Loss = 1.5809e-01, PNorm = 35.0071, GNorm = 1.5575, lr_0 = 2.5119e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 21.21it/s]Validation auc = 0.914402
Validation binary_cross_entropy = 0.217025
 60%|█████████████████████████████████████████████████████████████████▍                                           | 18/30 [00:15<00:10,  1.20it/s]Epoch 18
                                                                                                                                                  Loss = 2.0570e-01, PNorm = 35.0434, GNorm = 1.3971, lr_0 = 2.3779e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.96it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.84it/s]Validation auc = 0.914402
Validation binary_cross_entropy = 0.209607
 63%|█████████████████████████████████████████████████████████████████████                                        | 19/30 [00:16<00:08,  1.24it/s]Epoch 19
                                                                                                                                                  Loss = 1.4849e-01, PNorm = 35.0933, GNorm = 0.8857, lr_0 = 2.1309e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.93it/s]Validation auc = 0.914402
Validation binary_cross_entropy = 0.188881
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:17<00:08,  1.22it/s]Epoch 20
                                                                                                                                                  Loss = 5.3752e-02, PNorm = 35.1151, GNorm = 0.5920, lr_0 = 2.0173e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.5921e-01, PNorm = 35.1401, GNorm = 0.6902, lr_0 = 1.9096e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.87it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.80it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.84it/s]Validation auc = 0.914402
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.55it/s]Loss = 1.4496e-01, PNorm = 35.1930, GNorm = 0.7783, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.32it/s]Validation auc = 0.917120
Validation binary_cross_entropy = 0.216770
 73%|███████████████████████████████████████████████████████████████████████████████▉                             | 22/30 [00:19<00:06,  1.24it/s]Epoch 22
                                                                                                                                                  Loss = 1.5349e-01, PNorm = 35.2077, GNorm = 2.0093, lr_0 = 1.6200e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 21.83it/s]Validation auc = 0.918478
Validation binary_cross_entropy = 0.183070
 77%|███████████████████████████████████████████████████████████████████████████████████▌                         | 23/30 [00:19<00:05,  1.25it/s]Epoch 23
                                                                                                                                                  Loss = 1.1866e-01, PNorm = 35.2237, GNorm = 0.4282, lr_0 = 1.5336e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.71it/s]
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.55it/s]Loss = 1.4496e-01, PNorm = 35.1930, GNorm = 0.7783, lr_0 = 1.7113e-04
auc
binary_cross_entropy
auc
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.55it/s]Loss = 1.3857e-01, PNorm = 35.2601, GNorm = 0.3853, lr_0 = 1.3743e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.90it/s]Validation auc = 0.919837
Validation binary_cross_entropy = 0.184606
 83%|██████████████████████████████████████████████████████████████████████████████████████████▊                  | 25/30 [00:21<00:03,  1.28it/s]Epoch 25
                                                                                                                                                  Loss = 1.0167e-01, PNorm = 35.2761, GNorm = 0.5831, lr_0 = 1.3010e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.1944e-01, PNorm = 35.2932, GNorm = 0.5420, lr_0 = 1.2316e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.19it/s]Validation auc = 0.921196
Validation binary_cross_entropy = 0.176544
 87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 26/30 [00:22<00:03,  1.25it/s]Epoch 26
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.55it/s]Loss = 1.3857e-01, PNorm = 35.2601, GNorm = 0.3853, lr_0 = 1.3743e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:22<00:02,  1.26it/s]Epoch 27.3857e-01, PNorm = 35.2601, GNorm = 0.3853, lr_0 = 1.3743e-04
                                                                                                                                                  Loss = 1.1780e-01, PNorm = 35.3374, GNorm = 1.0740, lr_0 = 1.0448e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 20.37it/s]Validation auc = 0.919837
Validation binary_cross_entropy = 0.173474
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 28/30 [00:23<00:01,  1.26it/s]Epoch 28
                                                                                                                                                  Loss = 1.1129e-01, PNorm = 35.3513, GNorm = 0.4687, lr_0 = 1.0000e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 20.68it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:22<00:02,  1.26it/s]Epoch 27.3857e-01, PNorm = 35.2601, GNorm = 0.3853, lr_0 = 1.3743e-04
auc
binary_cross_entropy
auc
Ensemble test auc = 0.920962██████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:25<00:00,  1.18it/s]Epoch 27.3857e-01, PNorm = 35.2601, GNorm = 0.3853, lr_0 = 1.3743e-04
Model 0 best validation auc = 0.923913 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.920962
Model 0 test binary_cross_entropy = 0.102000
Ensemble test auc = 0.920962██████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:25<00:00,  1.18it/s]Epoch 27.3857e-01, PNorm = 35.2601, GNorm = 0.3853, lr_0 = 1.3743e-04
Ensemble test binary_cross_entropy = 0.102000
1-fold cross validation
	Seed 0 ==> test auc = 0.920962
	Seed 0 ==> test binary_cross_entropy = 0.102000
Overall test auc = 0.920962 +/- 0.000000
Overall test binary_cross_entropy = 0.102000 +/- 0.000000
Elapsed time = 0:00:31
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy