Fold 0
Splitting data with seed 0
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                      | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                  Loss = 3.9459e-01, PNorm = 34.0258, GNorm = 0.6065, lr_0 = 4.3000e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 15.00it/s]Validation auc = 0.513587
Validation binary_cross_entropy = 0.304513
  3%|███▋                                                                                                          | 1/30 [00:01<00:32,  1.14s/it]Epoch 1
                                                                                                                                                  Loss = 2.4347e-01, PNorm = 34.0446, GNorm = 0.1529, lr_0 = 7.6000e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.70it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.70it/s]
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.70it/s]Validation auc = 0.796196
Validation binary_cross_entropy = 0.263015
  7%|███████▎                                                                                                      | 2/30 [00:01<00:26,  1.06it/s]Epoch 2
                                                                                                                                                  Loss = 2.6228e-01, PNorm = 34.0985, GNorm = 0.5418, lr_0 = 9.3633e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.65it/s]Validation auc = 0.832880
Validation binary_cross_entropy = 0.265238
 10%|███████████                                                                                                   | 3/30 [00:02<00:23,  1.16it/s]Epoch 3
                                                                                                                                                  Loss = 3.1518e-01, PNorm = 34.1221, GNorm = 0.2292, lr_0 = 8.8638e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.3545e-01, PNorm = 34.1459, GNorm = 0.4104, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.71it/s]Validation auc = 0.846467
Validation binary_cross_entropy = 0.265165
 13%|██████████████▋                                                                                               | 4/30 [00:03<00:21,  1.20it/s]Epoch 4
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.78it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.88it/s]Validation auc = 0.854620
Validation binary_cross_entropy = 0.244579
 17%|██████████████████▎                                                                                           | 5/30 [00:04<00:20,  1.22it/s]Epoch 5
                                                                                                                                                  Loss = 2.3172e-01, PNorm = 34.2041, GNorm = 0.2423, lr_0 = 7.5195e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.3854e-01, PNorm = 34.2307, GNorm = 0.2309, lr_0 = 7.1184e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.80it/s]Validation auc = 0.858696
Validation binary_cross_entropy = 0.246991
 20%|██████████████████████                                                                                        | 6/30 [00:05<00:19,  1.22it/s]Epoch 6
                                                                                                                                                  Loss = 2.2353e-01, PNorm = 34.2642, GNorm = 0.2596, lr_0 = 6.7386e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 20.73it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 19.51it/s]
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 19.51it/s]Validation auc = 0.862772
Validation binary_cross_entropy = 0.237393
 23%|█████████████████████████▋                                                                                    | 7/30 [00:06<00:19,  1.18it/s]Epoch 7
                                                                                                                                                  Loss = 2.0294e-01, PNorm = 34.3420, GNorm = 0.1051, lr_0 = 6.0388e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.12it/s]Validation auc = 0.873641
Validation binary_cross_entropy = 0.231626
 27%|█████████████████████████████▎                                                                                | 8/30 [00:06<00:18,  1.20it/s]Epoch 8
                                                                                                                                                  Loss = 1.7754e-01, PNorm = 34.3794, GNorm = 0.3725, lr_0 = 5.7167e-04
 12%|█████████████▊                                                                                                | 2/16 [00:00<00:00, 19.78it/s]Loss = 2.3301e-01, PNorm = 34.4349, GNorm = 0.6902, lr_0 = 5.4117e-04
 69%|██████████████████████████████████████████████████████████████████████████▉                                  | 11/16 [00:00<00:00, 21.82it/s]Validation auc = 0.872283
Validation binary_cross_entropy = 0.232853
 30%|█████████████████████████████████                                                                             | 9/30 [00:07<00:17,  1.22it/s]Epoch 9
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.48it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 20.88it/s]Validation auc = 0.883152
Validation binary_cross_entropy = 0.230046
 33%|████████████████████████████████████▎                                                                        | 10/30 [00:08<00:16,  1.21it/s]Epoch 10
                                                                                                                                                  Loss = 1.2025e-01, PNorm = 34.5300, GNorm = 0.1375, lr_0 = 4.8497e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0841e-01, PNorm = 34.5652, GNorm = 0.2161, lr_0 = 4.5910e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.86it/s]Validation auc = 0.883152
Validation binary_cross_entropy = 0.223040
 37%|███████████████████████████████████████▉                                                                     | 11/30 [00:09<00:15,  1.23it/s]Epoch 11
                                                                                                                                                  Loss = 1.9366e-01, PNorm = 34.6230, GNorm = 0.4458, lr_0 = 4.3461e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.78it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.41it/s]
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.41it/s]Validation auc = 0.883152
Validation binary_cross_entropy = 0.216877
 40%|███████████████████████████████████████████▌                                                                 | 12/30 [00:10<00:15,  1.18it/s]Epoch 12
                                                                                                                                                  Loss = 1.8074e-01, PNorm = 34.7129, GNorm = 0.6483, lr_0 = 3.8947e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.21it/s]Validation auc = 0.889946
Validation binary_cross_entropy = 0.209372
 43%|███████████████████████████████████████████████▏                                                             | 13/30 [00:10<00:14,  1.21it/s]Epoch 13
                                                                                                                                                  Loss = 1.7150e-01, PNorm = 34.7513, GNorm = 0.2635, lr_0 = 3.6869e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.9484e-01, PNorm = 34.7935, GNorm = 1.0537, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.39it/s]Validation auc = 0.899457
Validation binary_cross_entropy = 0.207320
 47%|██████████████████████████████████████████████████▊                                                          | 14/30 [00:11<00:12,  1.23it/s]Epoch 14
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 21.13it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.46it/s]Validation auc = 0.902174
Validation binary_cross_entropy = 0.210536
 50%|██████████████████████████████████████████████████████▌                                                      | 15/30 [00:12<00:12,  1.24it/s]Epoch 15
                                                                                                                                                  Loss = 1.7937e-01, PNorm = 34.8772, GNorm = 0.5279, lr_0 = 3.1278e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7534e-01, PNorm = 34.9110, GNorm = 0.8384, lr_0 = 2.9609e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.16it/s]Validation auc = 0.908967
Validation binary_cross_entropy = 0.196209
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:13<00:11,  1.25it/s]Epoch 16
                                                                                                                                                  Loss = 1.3565e-01, PNorm = 34.9485, GNorm = 0.5163, lr_0 = 2.8030e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.23it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.75it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.216175                                                                                                        Validation auc = 0.908967
Validation binary_cross_entropy = 0.191392
 57%|█████████████████████████████████████████████████████████████▊                                               | 17/30 [00:14<00:10,  1.26it/s]Epoch 17
                                                                                                                                                  Loss = 1.5905e-01, PNorm = 35.0164, GNorm = 1.4932, lr_0 = 2.5119e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.22it/s]Validation auc = 0.913043
Validation binary_cross_entropy = 0.216175                                                                                                        Validation auc = 0.908967
 60%|█████████████████████████████████████████████████████████████████▍                                           | 18/30 [00:14<00:09,  1.26it/s]Epoch 18
                                                                                                                                                  Loss = 2.0731e-01, PNorm = 35.0547, GNorm = 1.3594, lr_0 = 2.3779e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.5032e-01, PNorm = 35.0896, GNorm = 0.6295, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.16it/s]Validation auc = 0.914402
Validation binary_cross_entropy = 0.209422
 63%|█████████████████████████████████████████████████████████████████████                                        | 19/30 [00:15<00:08,  1.25it/s]Epoch 19
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]Validation auc = 0.911685
Validation binary_cross_entropy = 0.187965
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:16<00:08,  1.24it/s]Epoch 20
                                                                                                                                                  Loss = 5.3782e-02, PNorm = 35.1306, GNorm = 0.5985, lr_0 = 2.0173e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.6057e-01, PNorm = 35.1574, GNorm = 0.6572, lr_0 = 1.9096e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 20.87it/s]Validation auc = 0.921196
Validation binary_cross_entropy = 0.200284
 70%|████████████████████████████████████████████████████████████████████████████▎                                | 21/30 [00:17<00:07,  1.22it/s]Epoch 21
                                                                                                                                                  Loss = 1.5579e-01, PNorm = 35.1798, GNorm = 0.9234, lr_0 = 1.8078e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 21.05it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.84it/s]
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]Validation auc = 0.911685
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]Loss = 1.5291e-01, PNorm = 35.2315, GNorm = 1.9160, lr_0 = 1.6200e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.43it/s]Validation auc = 0.918478
Validation binary_cross_entropy = 0.181401
 77%|███████████████████████████████████████████████████████████████████████████████████▌                         | 23/30 [00:18<00:05,  1.23it/s]Epoch 23
                                                                                                                                                  Loss = 1.1981e-01, PNorm = 35.2482, GNorm = 0.5267, lr_0 = 1.5336e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.4978e-01, PNorm = 35.2689, GNorm = 2.5320, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.05it/s]Validation auc = 0.918478
Validation binary_cross_entropy = 0.183367
 80%|███████████████████████████████████████████████████████████████████████████████████████▏                     | 24/30 [00:19<00:04,  1.25it/s]Epoch 24
                                                                                                                                                  Loss = 1.4049e-01, PNorm = 35.2873, GNorm = 0.4484, lr_0 = 1.3743e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.79it/s]
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]Loss = 1.5291e-01, PNorm = 35.2315, GNorm = 1.9160, lr_0 = 1.6200e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]Loss = 1.0347e-01, PNorm = 35.3034, GNorm = 0.6193, lr_0 = 1.3010e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.2108e-01, PNorm = 35.3222, GNorm = 0.5215, lr_0 = 1.2316e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.56it/s]Validation auc = 0.922554
Validation binary_cross_entropy = 0.175715
 87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 26/30 [00:21<00:03,  1.27it/s]Epoch 26
                                                                                                                                                  Loss = 1.3749e-01, PNorm = 35.3369, GNorm = 0.6435, lr_0 = 1.1659e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.65it/s]Loss = 1.3285e-01, PNorm = 35.3554, GNorm = 0.9714, lr_0 = 1.1037e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.88it/s]Validation auc = 0.921196
Validation binary_cross_entropy = 0.185070
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:22<00:02,  1.27it/s]Epoch 27
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 19.15it/s]Loss = 1.0347e-01, PNorm = 35.3034, GNorm = 0.6193, lr_0 = 1.3010e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 28/30 [00:22<00:01,  1.29it/s]Epoch 28.0347e-01, PNorm = 35.3034, GNorm = 0.6193, lr_0 = 1.3010e-04
                                                                                                                                                  Loss = 1.1059e-01, PNorm = 35.3848, GNorm = 0.4550, lr_0 = 1.0000e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.3099e-01, PNorm = 35.3963, GNorm = 0.8970, lr_0 = 1.0000e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.36it/s]Validation auc = 0.918478
Validation binary_cross_entropy = 0.175558
 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 29/30 [00:23<00:00,  1.29it/s]Epoch 29
                                                                                                                                                  Loss = 1.2730e-01, PNorm = 35.4132, GNorm = 0.8757, lr_0 = 1.0000e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.12it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.38it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 28/30 [00:22<00:01,  1.29it/s]Epoch 28.0347e-01, PNorm = 35.3034, GNorm = 0.6193, lr_0 = 1.3010e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Loading pretrained parameter "encoder.encoder.0.W_h.weight".██████████████████████████████████████████████▋       | 28/30 [00:22<00:01,  1.29it/s]Epoch 28.0347e-01, PNorm = 35.3034, GNorm = 0.6193, lr_0 = 1.3010e-04
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.920962
Model 0 test binary_cross_entropy = 0.118046
Ensemble test auc = 0.920962
Ensemble test binary_cross_entropy = 0.118046
Loading pretrained parameter "encoder.encoder.0.W_h.weight".██████████████████████████████████████████████▋       | 28/30 [00:22<00:01,  1.29it/s]Epoch 28.0347e-01, PNorm = 35.3034, GNorm = 0.6193, lr_0 = 1.3010e-04