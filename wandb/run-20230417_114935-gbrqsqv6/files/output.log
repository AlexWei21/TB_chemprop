Fold 1
Splitting data with seed 1
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                           | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                       Loss = 4.0233e-01, PNorm = 34.0252, GNorm = 0.5390, lr_0 = 4.3000e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 23.22it/s]Validation auc = 0.450077
  3%|██▊                                                                                | 1/30 [00:00<00:23,  1.24it/s]Epoch 1
                                                                                                                       Loss = 1.4296e-01, PNorm = 34.0476, GNorm = 0.4083, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.61it/s]Loss = 2.6266e-01, PNorm = 34.0790, GNorm = 0.2813, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.37it/s]Validation auc = 0.589862
  7%|█████▌                                                                             | 2/30 [00:01<00:22,  1.26it/s]Epoch 2
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.12it/s]Validation auc = 0.585253
 10%|████████▎                                                                          | 3/30 [00:02<00:21,  1.26it/s]Epoch 3
                                                                                                                       Loss = 1.9412e-01, PNorm = 34.1216, GNorm = 0.7694, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.7164e-01, PNorm = 34.1416, GNorm = 0.5521, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.43it/s]Validation auc = 0.582181
 13%|███████████                                                                        | 4/30 [00:03<00:20,  1.25it/s]Epoch 4
                                                                                                                       Loss = 1.8833e-01, PNorm = 34.1749, GNorm = 0.0643, lr_0 = 7.9433e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.88it/s]
 17%|█████████████▊                                                                     | 5/30 [00:04<00:20,  1.23it/s]Epoch 5
                                                                                                                       Loss = 2.0938e-01, PNorm = 34.1841, GNorm = 0.1684, lr_0 = 7.5195e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0785e-01, PNorm = 34.2152, GNorm = 0.2051, lr_0 = 7.1184e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 19.03it/s]Validation auc = 0.594470
 20%|████████████████▌                                                                  | 6/30 [00:05<00:21,  1.10it/s]Epoch 6
                                                                                                                       Loss = 2.2839e-01, PNorm = 34.2387, GNorm = 0.3371, lr_0 = 6.7386e-04
 25%|████████████████████▊                                                              | 4/16 [00:00<00:00, 19.03it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 19.70it/s]Validation auc = 0.583717
 23%|███████████████████▎                                                               | 7/30 [00:05<00:20,  1.12it/s]Epoch 7
                                                                                                                       Loss = 2.4550e-01, PNorm = 34.2937, GNorm = 0.5340, lr_0 = 6.0388e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.46it/s]Validation auc = 0.592934
 27%|██████████████████████▏                                                            | 8/30 [00:06<00:19,  1.14it/s]Epoch 8
                                                                                                                       Loss = 2.4835e-01, PNorm = 34.3467, GNorm = 0.5205, lr_0 = 5.7167e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0568e-01, PNorm = 34.3641, GNorm = 0.4113, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.41it/s]Validation auc = 0.606759
 30%|████████████████████████▉                                                          | 9/30 [00:07<00:18,  1.15it/s]Epoch 9
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.43it/s]Validation auc = 0.609831
 33%|███████████████████████████▎                                                      | 10/30 [00:08<00:16,  1.18it/s]Epoch 10
                                                                                                                       Loss = 1.6523e-01, PNorm = 34.4379, GNorm = 0.2787, lr_0 = 4.8497e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.9649e-01, PNorm = 34.4702, GNorm = 0.2085, lr_0 = 4.5910e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.78it/s]Validation auc = 0.603687
 37%|██████████████████████████████                                                    | 11/30 [00:09<00:15,  1.21it/s]Epoch 11
                                                                                                                       Loss = 1.6339e-01, PNorm = 34.5055, GNorm = 0.2054, lr_0 = 4.3461e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.49it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.31it/s]Validation auc = 0.619048
 40%|████████████████████████████████▊                                                 | 12/30 [00:10<00:14,  1.21it/s]Epoch 12
                                                                                                                       Loss = 1.9020e-01, PNorm = 34.5719, GNorm = 0.1954, lr_0 = 3.8947e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.14it/s]Validation auc = 0.600614
 43%|███████████████████████████████████▌                                              | 13/30 [00:10<00:13,  1.24it/s]Epoch 13
                                                                                                                       Loss = 1.2047e-01, PNorm = 34.6132, GNorm = 0.2863, lr_0 = 3.6869e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.9921e-01, PNorm = 34.6290, GNorm = 0.3091, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.05it/s]Validation auc = 0.645161
 47%|██████████████████████████████████████▎                                           | 14/30 [00:11<00:12,  1.25it/s]Epoch 14
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.03it/s]Validation auc = 0.654378
 50%|█████████████████████████████████████████                                         | 15/30 [00:12<00:11,  1.26it/s]Epoch 15
                                                                                                                       Loss = 3.1295e-01, PNorm = 34.7059, GNorm = 0.9174, lr_0 = 3.1278e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5807e-01, PNorm = 34.7378, GNorm = 0.5033, lr_0 = 2.9609e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.46it/s]Validation auc = 0.678955
 53%|███████████████████████████████████████████▋                                      | 16/30 [00:13<00:11,  1.26it/s]Epoch 16
                                                                                                                       Loss = 1.7212e-01, PNorm = 34.7658, GNorm = 0.5771, lr_0 = 2.8030e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.56it/s]Loss = 1.6734e-01, PNorm = 34.8072, GNorm = 0.4236, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.36it/s]
 57%|██████████████████████████████████████████████▍                                   | 17/30 [00:13<00:10,  1.26it/s]Epoch 17
                                                                                                                       Loss = 2.0387e-01, PNorm = 34.8332, GNorm = 0.7621, lr_0 = 2.5119e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.33it/s]Validation auc = 0.688172
 60%|█████████████████████████████████████████████████▏                                | 18/30 [00:14<00:09,  1.27it/s]Epoch 18
                                                                                                                       Loss = 1.5557e-01, PNorm = 34.8726, GNorm = 1.2453, lr_0 = 2.3779e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.9119e-01, PNorm = 34.8779, GNorm = 1.1219, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.94it/s]Validation auc = 0.718894
 63%|███████████████████████████████████████████████████▉                              | 19/30 [00:15<00:08,  1.27it/s]Epoch 19
                                                                                                                       Loss = 1.7371e-01, PNorm = 34.9159, GNorm = 1.0592, lr_0 = 2.1309e-04
 31%|█████████████████████████▉                                                         | 5/16 [00:00<00:00, 19.95it/s]
 67%|██████████████████████████████████████████████████████▋                           | 20/30 [00:16<00:08,  1.24it/s]Epoch 20
                                                                                                                       Loss = 1.0485e-01, PNorm = 34.9315, GNorm = 0.5566, lr_0 = 2.0173e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.8281e-01, PNorm = 34.9531, GNorm = 0.5773, lr_0 = 1.9096e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.40it/s]Validation auc = 0.726575
 70%|█████████████████████████████████████████████████████████▍                        | 21/30 [00:17<00:07,  1.23it/s]Epoch 21
                                                                                                                       Loss = 1.4501e-01, PNorm = 34.9803, GNorm = 0.6506, lr_0 = 1.8078e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.07it/s]Loss = 1.4601e-01, PNorm = 34.9930, GNorm = 0.3358, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.33it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 22/30 [00:18<00:06,  1.23it/s]Loss = 1.5921e-01, PNorm = 35.0702, GNorm = 0.5753, lr_0 = 1.3743e-04
                                                                                                                       Loss = 1.4739e-01, PNorm = 35.0209, GNorm = 0.4880, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.51it/s]Validation auc = 0.746544
 77%|██████████████████████████████████████████████████████████████▊                   | 23/30 [00:18<00:05,  1.24it/s]Epoch 23
                                                                                                                       Loss = 1.2960e-01, PNorm = 35.0293, GNorm = 0.6546, lr_0 = 1.5336e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5394e-01, PNorm = 35.0552, GNorm = 0.4516, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.86it/s]Validation auc = 0.741935
 80%|█████████████████████████████████████████████████████████████████▌                | 24/30 [00:19<00:04,  1.24it/s]Epoch 24
 73%|████████████████████████████████████████████████████████████▏                     | 22/30 [00:18<00:06,  1.23it/s]Loss = 1.5921e-01, PNorm = 35.0702, GNorm = 0.5753, lr_0 = 1.3743e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.46it/s]
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Epoch 25
                                                                                                                       Loss = 1.2735e-01, PNorm = 35.0872, GNorm = 0.2872, lr_0 = 1.3010e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5934e-01, PNorm = 35.1024, GNorm = 1.2960, lr_0 = 1.2316e-04
 62%|███████████████████████████████████████████████████▎                              | 10/16 [00:00<00:00, 21.62it/s]Validation auc = 0.743472
 87%|███████████████████████████████████████████████████████████████████████           | 26/30 [00:21<00:03,  1.26it/s]Epoch 26
                                                                                                                       Loss = 1.2397e-01, PNorm = 35.1226, GNorm = 0.4940, lr_0 = 1.1659e-04
 12%|██████████▍                                                                        | 2/16 [00:00<00:00, 19.52it/s]Loss = 1.4288e-01, PNorm = 35.1302, GNorm = 0.4266, lr_0 = 1.1037e-04
 88%|███████████████████████████████████████████████████████████████████████▊          | 14/16 [00:00<00:00, 22.68it/s]Validation auc = 0.761905
 90%|█████████████████████████████████████████████████████████████████████████▊        | 27/30 [00:22<00:02,  1.24it/s]Epoch 27
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.58it/s]Validation auc = 0.766513
 93%|████████████████████████████████████████████████████████████████████████████▌     | 28/30 [00:22<00:01,  1.21it/s]Epoch 28
                                                                                                                       Loss = 1.5868e-01, PNorm = 35.1560, GNorm = 0.9130, lr_0 = 1.0000e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.4733e-01, PNorm = 35.1769, GNorm = 1.1719, lr_0 = 1.0000e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.41it/s]Validation auc = 0.751152
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 29/30 [00:23<00:00,  1.24it/s]Epoch 29
                                                                                                                       Loss = 1.4408e-01, PNorm = 35.1849, GNorm = 0.5996, lr_0 = 1.0000e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.94it/s]
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.99it/s]
Ensemble test auc = 0.839674 "encoder.encoder.0.cached_zero_vector".                    | 6/16 [00:00<00:00, 23.58it/s]Validation auc = 0.766513
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.839674
Ensemble test auc = 0.839674 "encoder.encoder.0.cached_zero_vector".                    | 6/16 [00:00<00:00, 23.58it/s]Validation auc = 0.766513