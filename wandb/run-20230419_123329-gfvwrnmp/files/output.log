Fold 4
Splitting data with seed 4
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                      | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                  Loss = 3.9676e-01, PNorm = 34.0254, GNorm = 0.0925, lr_0 = 4.3000e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.38it/s]Validation auc = 0.573871
Validation binary_cross_entropy = 0.365116
  3%|███▋                                                                                                          | 1/30 [00:00<00:24,  1.20it/s]Epoch 1
                                                                                                                                                  Loss = 2.4528e-01, PNorm = 34.0437, GNorm = 0.0627, lr_0 = 7.6000e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.09it/s]Loss = 2.4079e-01, PNorm = 34.0752, GNorm = 1.0401, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.51it/s]Validation auc = 0.669109
Validation binary_cross_entropy = 0.287970
  7%|███████▎                                                                                                      | 2/30 [00:01<00:22,  1.23it/s]Epoch 2
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.59it/s]Validation auc = 0.670330
Validation binary_cross_entropy = 0.285723
 10%|███████████                                                                                                   | 3/30 [00:02<00:21,  1.25it/s]Epoch 3
                                                                                                                                                  Loss = 2.9136e-01, PNorm = 34.1236, GNorm = 0.7898, lr_0 = 8.8638e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0132e-01, PNorm = 34.1494, GNorm = 0.4690, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.20it/s]Validation auc = 0.709402
Validation binary_cross_entropy = 0.280258
 13%|██████████████▋                                                                                               | 4/30 [00:03<00:20,  1.26it/s]Epoch 4
                                                                                                                                                  Loss = 2.2341e-01, PNorm = 34.1602, GNorm = 0.1777, lr_0 = 7.9433e-04
 31%|██████████████████████████████████▍                                                                           | 5/16 [00:00<00:00, 21.42it/s]
 69%|██████████████████████████████████████████████████████████████████████████▉                                  | 11/16 [00:00<00:00, 22.89it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.277668
 17%|██████████████████▎                                                                                           | 5/30 [00:03<00:19,  1.26it/s]Epoch 5
                                                                                                                                                  Loss = 4.3748e-01, PNorm = 34.1828, GNorm = 0.7520, lr_0 = 7.5195e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.1632e-01, PNorm = 34.2147, GNorm = 0.5620, lr_0 = 7.1184e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.31it/s]Validation auc = 0.731380
Validation binary_cross_entropy = 0.281020
 20%|██████████████████████                                                                                        | 6/30 [00:04<00:18,  1.28it/s]Epoch 6
                                                                                                                                                  Loss = 2.0979e-01, PNorm = 34.2400, GNorm = 0.3103, lr_0 = 6.7386e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.82it/s]Loss = 2.2208e-01, PNorm = 34.2781, GNorm = 0.2477, lr_0 = 6.3791e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.60it/s]Validation auc = 0.750916
Validation binary_cross_entropy = 0.290332
 23%|█████████████████████████▋                                                                                    | 7/30 [00:05<00:17,  1.28it/s]Epoch 7
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.81it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.81it/s]Validation auc = 0.754579
Validation binary_cross_entropy = 0.269290
 27%|█████████████████████████████▎                                                                                | 8/30 [00:06<00:17,  1.27it/s]Epoch 8
                                                                                                                                                  Loss = 1.7508e-01, PNorm = 34.3446, GNorm = 0.2549, lr_0 = 5.7167e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.2263e-01, PNorm = 34.3768, GNorm = 0.3507, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.20it/s]Validation auc = 0.771673
Validation binary_cross_entropy = 0.269093
 30%|█████████████████████████████████                                                                             | 9/30 [00:07<00:16,  1.27it/s]Epoch 9
                                                                                                                                                  Loss = 1.8663e-01, PNorm = 34.4270, GNorm = 0.2328, lr_0 = 5.1230e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.12it/s]
 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 15/16 [00:00<00:00, 22.82it/s]
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.260759
 33%|████████████████████████████████████▎                                                                        | 10/30 [00:07<00:15,  1.26it/s]Epoch 10
                                                                                                                                                  Loss = 3.2797e-01, PNorm = 34.4629, GNorm = 0.6696, lr_0 = 4.8497e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7180e-01, PNorm = 34.5104, GNorm = 0.2487, lr_0 = 4.5910e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.56it/s]Validation auc = 0.772894
Validation binary_cross_entropy = 0.259133
 37%|███████████████████████████████████████▉                                                                     | 11/30 [00:08<00:14,  1.28it/s]Epoch 11
                                                                                                                                                  Loss = 2.3514e-01, PNorm = 34.5483, GNorm = 0.5118, lr_0 = 4.3461e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 24.10it/s]Loss = 1.6064e-01, PNorm = 34.6054, GNorm = 0.5045, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.37it/s]Validation auc = 0.793651
Validation binary_cross_entropy = 0.282633
 40%|███████████████████████████████████████████▌                                                                 | 12/30 [00:09<00:14,  1.27it/s]Epoch 12
                                                                                                                                                  Loss = 1.5844e-01, PNorm = 34.6379, GNorm = 0.5362, lr_0 = 3.8947e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.71it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.39it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.264579
 43%|███████████████████████████████████████████████▏                                                             | 13/30 [00:10<00:13,  1.27it/s]Epoch 13
                                                                                                                                                  Loss = 1.4598e-01, PNorm = 34.6842, GNorm = 0.2130, lr_0 = 3.6869e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7003e-01, PNorm = 34.7262, GNorm = 0.3358, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.97it/s]Validation auc = 0.791209
Validation binary_cross_entropy = 0.271455
 47%|██████████████████████████████████████████████████▊                                                          | 14/30 [00:11<00:12,  1.27it/s]Epoch 14
                                                                                                                                                  Loss = 1.8264e-01, PNorm = 34.7596, GNorm = 1.2726, lr_0 = 3.3041e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.09it/s]Validation auc = 0.769231
Validation binary_cross_entropy = 0.261697
 50%|██████████████████████████████████████████████████████▌                                                      | 15/30 [00:11<00:11,  1.27it/s]Epoch 15
                                                                                                                                                  Loss = 2.2729e-01, PNorm = 34.7867, GNorm = 0.5950, lr_0 = 3.1278e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.5769e-01, PNorm = 34.8293, GNorm = 0.7144, lr_0 = 2.9609e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.61it/s]Validation auc = 0.775336
Validation binary_cross_entropy = 0.258934
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:12<00:11,  1.27it/s]Epoch 16
                                                                                                                                                  Loss = 1.3895e-01, PNorm = 34.8532, GNorm = 1.3855, lr_0 = 2.8030e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 24.28it/s]Loss = 1.8027e-01, PNorm = 34.8873, GNorm = 0.5799, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.45it/s]Validation auc = 0.792430
Validation binary_cross_entropy = 0.316748
 57%|█████████████████████████████████████████████████████████████▊                                               | 17/30 [00:13<00:10,  1.29it/s]Epoch 17
                                                                                                                                                  Loss = 1.8840e-01, PNorm = 34.9089, GNorm = 1.0964, lr_0 = 2.5119e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.63it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.55it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:15<00:07,  1.30it/s]Epoch 20
 60%|█████████████████████████████████████████████████████████████████▍                                           | 18/30 [00:14<00:09,  1.31it/s]Epoch 18
                                                                                                                                                  Loss = 1.2504e-01, PNorm = 34.9373, GNorm = 0.1984, lr_0 = 2.3779e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.6478e-01, PNorm = 34.9578, GNorm = 0.4619, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.49it/s]Validation auc = 0.783883
Validation binary_cross_entropy = 0.277713
 63%|█████████████████████████████████████████████████████████████████████                                        | 19/30 [00:14<00:08,  1.31it/s]Epoch 19
                                                                                                                                                  Loss = 1.7139e-01, PNorm = 34.9789, GNorm = 0.3466, lr_0 = 2.1309e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.54it/s]Validation auc = 0.797314
Validation binary_cross_entropy = 0.283764
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:15<00:07,  1.30it/s]Epoch 20
                                                                                                                                                  Loss = 2.1996e-01, PNorm = 35.0086, GNorm = 1.2148, lr_0 = 2.0173e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.87it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Validation auc = 0.794872
Validation binary_cross_entropy = 0.297668
 70%|████████████████████████████████████████████████████████████████████████████▎                                | 21/30 [00:16<00:06,  1.29it/s]Epoch 21
                                                                                                                                                  Loss = 1.4764e-01, PNorm = 35.0500, GNorm = 0.3395, lr_0 = 1.8078e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.13it/s]Loss = 1.3237e-01, PNorm = 35.0722, GNorm = 1.2541, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.22it/s]Validation auc = 0.785104
Validation binary_cross_entropy = 0.283602
 73%|███████████████████████████████████████████████████████████████████████████████▉                             | 22/30 [00:17<00:06,  1.31it/s]Epoch 22
                                                                                                                                                  Loss = 1.5258e-01, PNorm = 35.0889, GNorm = 0.6562, lr_0 = 1.6200e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.95it/s]Validation auc = 0.789988
Validation binary_cross_entropy = 0.269976
 77%|███████████████████████████████████████████████████████████████████████████████████▌                         | 23/30 [00:17<00:05,  1.31it/s]Epoch 23
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Validation auc = 0.794872
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.3314e-01, PNorm = 35.1269, GNorm = 1.1815, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.59it/s]Validation auc = 0.786325
Validation binary_cross_entropy = 0.268996
 80%|███████████████████████████████████████████████████████████████████████████████████████▏                     | 24/30 [00:18<00:04,  1.31it/s]Epoch 24
                                                                                                                                                  Loss = 1.3011e-01, PNorm = 35.1473, GNorm = 0.8192, lr_0 = 1.3743e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.38it/s]Validation auc = 0.786325
Validation binary_cross_entropy = 0.278635
 83%|██████████████████████████████████████████████████████████████████████████████████████████▊                  | 25/30 [00:19<00:03,  1.26it/s]Epoch 25
                                                                                                                                                  Loss = 7.7913e-02, PNorm = 35.1667, GNorm = 0.6880, lr_0 = 1.3010e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.6400e-01, PNorm = 35.1747, GNorm = 1.3797, lr_0 = 1.2316e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.34it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.11it/s]
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.3314e-01, PNorm = 35.1269, GNorm = 1.1815, lr_0 = 1.4518e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.4989e-01, PNorm = 35.1951, GNorm = 0.4994, lr_0 = 1.1659e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.00it/s]Loss = 1.2274e-01, PNorm = 35.2054, GNorm = 1.6711, lr_0 = 1.1037e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.59it/s]Validation auc = 0.783883
Validation binary_cross_entropy = 0.276370
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:21<00:02,  1.29it/s]Epoch 27
                                                                                                                                                  Loss = 1.2776e-01, PNorm = 35.2175, GNorm = 0.4039, lr_0 = 1.0448e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 20.58it/s]Validation auc = 0.788767
Validation binary_cross_entropy = 0.271857
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 28/30 [00:21<00:01,  1.27it/s]Epoch 28
                                                                                                                                                  Loss = 8.6396e-02, PNorm = 35.2293, GNorm = 1.4387, lr_0 = 1.0000e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 21.89it/s]
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.4989e-01, PNorm = 35.1951, GNorm = 0.4994, lr_0 = 1.1659e-04
auc
binary_cross_entropy
auc
Loading pretrained parameter "readout.4.weight".██████████████████████████████████████████████████████████████▎   | 29/30 [00:22<00:00,  1.25it/s]Epoch 29.4989e-01, PNorm = 35.1951, GNorm = 0.4994, lr_0 = 1.1659e-04
                                                                                                                                                  Loss = 1.4210e-01, PNorm = 35.2527, GNorm = 0.3941, lr_0 = 1.0000e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.10it/s]Validation auc = 0.792430
Validation binary_cross_entropy = 0.280883
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:23<00:00,  1.27it/s]
Model 0 best validation auc = 0.797314 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".██████████████████████████████████████████████████████████████▎   | 29/30 [00:22<00:00,  1.25it/s]Epoch 29.4989e-01, PNorm = 35.1951, GNorm = 0.4994, lr_0 = 1.1659e-04
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.905263
Model 0 test binary_cross_entropy = 0.148363
Ensemble test auc = 0.905263
Ensemble test binary_cross_entropy = 0.148363
5-fold cross validation
	Seed 0 ==> test auc = 0.920962
	Seed 0 ==> test binary_cross_entropy = 0.118046
	Seed 1 ==> test auc = 0.839674
	Seed 1 ==> test binary_cross_entropy = 0.222752
	Seed 2 ==> test auc = 0.776842
	Seed 2 ==> test binary_cross_entropy = 0.179619
	Seed 3 ==> test auc = 0.855607
	Seed 3 ==> test binary_cross_entropy = 0.193339
	Seed 4 ==> test auc = 0.905263
	Seed 4 ==> test binary_cross_entropy = 0.148363
Overall test auc = 0.859670 +/- 0.051210
Overall test binary_cross_entropy = 0.172424 +/- 0.036216
Elapsed time = 0:02:40
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy