Fold 0
Splitting data with seed 0
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                           | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                       Loss = 3.9459e-01, PNorm = 34.0258, GNorm = 0.6065, lr_0 = 4.3000e-04
 50%|█████████████████████████████████████████▌                                         | 8/16 [00:00<00:00, 14.84it/s]Validation auc = 0.513587
  3%|██▊                                                                                | 1/30 [00:01<00:33,  1.17s/it]Epoch 1
                                                                                                                       Loss = 2.4347e-01, PNorm = 34.0446, GNorm = 0.1529, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.41it/s]
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.21it/s]
auc
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.27it/s]Validation auc = 0.796196
  7%|█████▌                                                                             | 2/30 [00:01<00:27,  1.03it/s]Epoch 2
                                                                                                                       Loss = 2.6228e-01, PNorm = 34.0985, GNorm = 0.5418, lr_0 = 9.3633e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.05it/s]Validation auc = 0.832880
 10%|████████▎                                                                          | 3/30 [00:02<00:24,  1.12it/s]Epoch 3
                                                                                                                       Loss = 3.1518e-01, PNorm = 34.1221, GNorm = 0.2292, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.3545e-01, PNorm = 34.1459, GNorm = 0.4104, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.85it/s]Validation auc = 0.846467
 13%|███████████                                                                        | 4/30 [00:03<00:22,  1.15it/s]Epoch 4
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]
auc
auc
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.48it/s]Validation auc = 0.854620
 17%|█████████████▊                                                                     | 5/30 [00:04<00:21,  1.17it/s]Epoch 5
                                                                                                                       Loss = 2.3172e-01, PNorm = 34.2041, GNorm = 0.2423, lr_0 = 7.5195e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.3854e-01, PNorm = 34.2307, GNorm = 0.2309, lr_0 = 7.1184e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 19.24it/s]Validation auc = 0.858696
 20%|████████████████▌                                                                  | 6/30 [00:05<00:20,  1.16it/s]Epoch 6
                                                                                                                       Loss = 2.2353e-01, PNorm = 34.2642, GNorm = 0.2596, lr_0 = 6.7386e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.09it/s]
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.68it/s]
auc
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.35it/s]                                         Validation auc = 0.862772
 23%|███████████████████▎                                                               | 7/30 [00:06<00:19,  1.17it/s]Epoch 7
                                                                                                                                                                Loss = 2.0294e-01, PNorm = 34.3420, GNorm = 0.1051, lr_0 = 6.0388e-04
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 22.44it/s]Validation auc = 0.873641
 27%|██████████████████████▏                                                            | 8/30 [00:06<00:18,  1.19it/s]Epoch 8
                                                                                                                                                                Loss = 1.7754e-01, PNorm = 34.3794, GNorm = 0.3725, lr_0 = 5.7167e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 2.3302e-01, PNorm = 34.4349, GNorm = 0.6902, lr_0 = 5.4117e-04
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.88it/s]Validation auc = 0.872283
 30%|████████████████████████▉                                                          | 9/30 [00:07<00:17,  1.22it/s]Epoch 9
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]
auc
auc
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 21.02it/s]Validation auc = 0.883152
 33%|███████████████████████████▎                                                      | 10/30 [00:08<00:17,  1.18it/s]Epoch 10
                                                                                                                                                                Loss = 1.2024e-01, PNorm = 34.5299, GNorm = 0.1376, lr_0 = 4.8497e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 2.0843e-01, PNorm = 34.5649, GNorm = 0.2136, lr_0 = 4.5910e-04
 56%|█████████████████████████████████████████████████████████████████████▊                                                      | 9/16 [00:00<00:00, 21.47it/s]Validation auc = 0.881793
 37%|██████████████████████████████                                                    | 11/30 [00:09<00:15,  1.20it/s]Epoch 11
                                                                                                                                                                Loss = 1.9358e-01, PNorm = 34.6225, GNorm = 0.4447, lr_0 = 4.3461e-04
 19%|███████████████████████▎                                                                                                    | 3/16 [00:00<00:00, 22.67it/s]
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 22.43it/s]
auc
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 21.83it/s]Validation auc = 0.883152
 40%|████████████████████████████████▊                                                 | 12/30 [00:10<00:14,  1.21it/s]Epoch 12
                                                                                                                                                                Loss = 1.8080e-01, PNorm = 34.7123, GNorm = 0.6354, lr_0 = 3.8947e-04
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 23.23it/s]Validation auc = 0.892663
 43%|███████████████████████████████████▌                                              | 13/30 [00:11<00:13,  1.22it/s]Epoch 13
                                                                                                                                                                Loss = 1.7149e-01, PNorm = 34.7503, GNorm = 0.2622, lr_0 = 3.6869e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 1.9468e-01, PNorm = 34.7929, GNorm = 1.0919, lr_0 = 3.4903e-04
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.50it/s]Validation auc = 0.896739
auc
auc
auc
 47%|██████████████████████████████████████▎                                           | 14/30 [00:11<00:13,  1.22it/s]Epoch 14
                                                                                                                                                                Loss = 1.8822e-01, PNorm = 34.8399, GNorm = 0.4518, lr_0 = 3.3041e-04
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 22.94it/s]Validation auc = 0.902174
 50%|█████████████████████████████████████████                                         | 15/30 [00:12<00:12,  1.22it/s]Epoch 15
                                                                                                                                                                Loss = 1.7895e-01, PNorm = 34.8761, GNorm = 0.5140, lr_0 = 3.1278e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 1.7531e-01, PNorm = 34.9093, GNorm = 0.8618, lr_0 = 2.9609e-04
 50%|██████████████████████████████████████████████████████████████                                                              | 8/16 [00:00<00:00, 22.29it/s]Validation auc = 0.911685
 53%|███████████████████████████████████████████▋                                      | 16/30 [00:13<00:11,  1.23it/s]Epoch 16
                                                                                                                                                                Loss = 1.3560e-01, PNorm = 34.9464, GNorm = 0.5238, lr_0 = 2.8030e-04
 19%|███████████████████████▎                                                                                                    | 3/16 [00:00<00:00, 21.77it/s]
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 21.81it/s]
auc
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.51it/s]Validation auc = 0.908967
 57%|██████████████████████████████████████████████▍                                   | 17/30 [00:14<00:10,  1.25it/s]Epoch 17
                                                                                                                                                                Loss = 1.5912e-01, PNorm = 35.0135, GNorm = 1.5042, lr_0 = 2.5119e-04
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 23.30it/s]Validation auc = 0.911685
 60%|█████████████████████████████████████████████████▏                                | 18/30 [00:15<00:09,  1.26it/s]Epoch 18
                                                                                                                                                                Loss = 2.0757e-01, PNorm = 35.0512, GNorm = 1.3679, lr_0 = 2.3779e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 1.5074e-01, PNorm = 35.0861, GNorm = 0.5842, lr_0 = 2.2510e-04
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.43it/s]Validation auc = 0.914402
 63%|███████████████████████████████████████████████████▉                              | 19/30 [00:15<00:08,  1.26it/s]Epoch 19
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]
auc
auc
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 22.71it/s]Validation auc = 0.910326
 67%|██████████████████████████████████████████████████████▋                           | 20/30 [00:16<00:07,  1.28it/s]Epoch 20
                                                                                                                                                                Loss = 5.4103e-02, PNorm = 35.1271, GNorm = 0.5688, lr_0 = 2.0173e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 1.6054e-01, PNorm = 35.1532, GNorm = 0.6594, lr_0 = 1.9096e-04
 56%|█████████████████████████████████████████████████████████████████████▊                                                      | 9/16 [00:00<00:00, 22.56it/s]Validation auc = 0.921196
 70%|█████████████████████████████████████████████████████████▍                        | 21/30 [00:17<00:07,  1.28it/s]Epoch 21
                                                                                                                                                                Loss = 1.5616e-01, PNorm = 35.1753, GNorm = 0.9309, lr_0 = 1.8078e-04
 19%|███████████████████████▎                                                                                                    | 3/16 [00:00<00:00, 22.73it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.46it/s]
auc
auc
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.32it/s]Validation Validation auc = 0.921196
 73%|████████████████████████████████████████████████████████████▏                     | 22/30 [00:18<00:06,  1.28it/s]Epoch 22
                                                                                                                                                                Loss = 1.5348e-01, PNorm = 35.2257, GNorm = 1.9391, lr_0 = 1.6200e-04
 38%|██████████████████████████████████████████████▌                                                                             | 6/16 [00:00<00:00, 23.23it/s]Validation auc = 0.918478
 77%|██████████████████████████████████████████████████████████████▊                   | 23/30 [00:18<00:05,  1.29it/s]Epoch 23
                                                                                                                                                                Loss = 1.2009e-01, PNorm = 35.2427, GNorm = 0.4680, lr_0 = 1.5336e-04
  0%|                                                                                                                                    | 0/16 [00:00<?, ?it/s]Loss = 1.4969e-01, PNorm = 35.2631, GNorm = 2.4907, lr_0 = 1.4518e-04
 75%|████████████████████████████████████████████████████████████████████████████████████████████▎                              | 12/16 [00:00<00:00, 22.32it/s]Validation Validation auc = 0.921196
 80%|█████████████████████████████████████████████████████████████████▌                | 24/30 [00:19<00:04,  1.29it/s]Epoch 24
                                                                                                                                                                           Loss = 1.4058e-01, PNorm = 35.2808, GNorm = 0.4058, lr_0 = 1.3743e-04
 38%|██████████████████████████████████████████████████▋                                                                                    | 6/16 [00:00<00:00, 22.05it/s]
auc
 38%|██████████████████████████████████████████████████▋                                                                        Validation auc = 0.919837<00:00, 22.05it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 25/30 [00:20<00:03,  1.28it/s]Epoch 25
                                                                                                                           Loss = 1.0328e-01, PNorm = 35.2970, GNorm = 0.5950, lr_0 = 1.3010e-04
  0%|                                                                                               | 0/16 [00:00<?, ?it/s]Loss = 1.2115e-01, PNorm = 35.3156, GNorm = 0.5278, lr_0 = 1.2316e-04
 56%|████████████████████████████████████████████████▉                                      | 9/16 [00:00<00:00, 21.63it/s]Validation auc = 0.922554
 87%|███████████████████████████████████████████████████████████████████████           | 26/30 [00:21<00:03,  1.27it/s]Epoch 26
                                                                                                                           Loss = 1.3750e-01, PNorm = 35.3300, GNorm = 0.6300, lr_0 = 1.1659e-04
 19%|████████████████▎                                                                      | 3/16 [00:00<00:00, 22.43it/s]Loss = 1.3300e-01, PNorm = 35.3481, GNorm = 0.9452, lr_0 = 1.1037e-04
 75%|████████████████████████████████████████████████████████████████▌                     | 12/16 [00:00<00:00, 21.56it/s]
  0%|                                                                                                                       | 0/2 [00:00<?, ?it/s]
 38%|██████████████████████████████████████████████████▋                                                                        Validation auc = 0.919837<00:00, 22.05it/s]
auc
auc
 38%|██████████████████████████████████████████████████▋                                                                        Validation auc = 0Loss = 1.1920e-01, PNorm = 35.3622, GNorm = 1.0710, lr_0 = 1.0448e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.64it/s]Validation auc = 0.921196
 93%|████████████████████████████████████████████████████████████████████████████▌     | 28/30 [00:22<00:01,  1.29it/s]Epoch 28
                                                                                                                                                  Loss = 1.1074e-01, PNorm = 35.3769, GNorm = 0.4499, lr_0 = 1.0000e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.3129e-01, PNorm = 35.3882, GNorm = 0.8687, lr_0 = 1.0000e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.17it/s]Validation auc = 0.918478
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 29/30 [00:23<00:00,  1.31it/s]Epoch 29
                                                                                                                                                  Loss = 1.2739e-01, PNorm = 35.4048, GNorm = 0.8553, lr_0 = 1.0000e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.07it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.44it/s]
 38%|██████████████████████████████████████████████████▋                                                                        Validation auc = 0Loss = 1.1920e-01, PNorm = 35.3622, GNorm = 1.0710, lr_0 = 1.0448e-04
auc
auc
auc
Model 0 test auc = 0.920962                                                                                                                       Loss = 1.1920e-01, PNorm = 35.3622, GNorm = 1.0710, lr_0 = 1.0448e-04
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.920962                                                                                                                       Loss = 1.1920e-01, PNorm = 35.3622, GNorm = 1.0710, lr_0 = 1.0448e-04
Ensemble test auc = 0.920962
1-fold cross validation
	Seed 0 ==> test auc = 0.920962
Overall test auc = 0.920962 +/- 0.000000
Elapsed time = 0:00:31