Fold 4
Splitting data with seed 4
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                           | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                       Loss = 3.9676e-01, PNorm = 34.0254, GNorm = 0.0925, lr_0 = 4.3000e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.29it/s]Validation auc = 0.573871
  3%|██▊                                                                                | 1/30 [00:00<00:24,  1.21it/s]Epoch 1
                                                                                                                       Loss = 2.4528e-01, PNorm = 34.0437, GNorm = 0.0627, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 21.81it/s]Loss = 2.4079e-01, PNorm = 34.0752, GNorm = 1.0401, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.22it/s]Validation auc = 0.669109
  7%|█████▌                                                                             | 2/30 [00:01<00:23,  1.20it/s]Epoch 2
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.66it/s]Validation auc = 0.670330
 10%|████████▎                                                                          | 3/30 [00:02<00:22,  1.21it/s]Epoch 3
                                                                                                                       Loss = 2.9136e-01, PNorm = 34.1236, GNorm = 0.7898, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0132e-01, PNorm = 34.1494, GNorm = 0.4690, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.74it/s]Validation auc = 0.709402
 13%|███████████                                                                        | 4/30 [00:03<00:21,  1.21it/s]Epoch 4
                                                                                                                       Loss = 2.2341e-01, PNorm = 34.1602, GNorm = 0.1777, lr_0 = 7.9433e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.64it/s]
 17%|█████████████▊                                                                     | 5/30 [00:04<00:20,  1.22it/s]Epoch 5
                                                                                                                       Loss = 4.3748e-01, PNorm = 34.1828, GNorm = 0.7520, lr_0 = 7.5195e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.1632e-01, PNorm = 34.2147, GNorm = 0.5620, lr_0 = 7.1184e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.54it/s]Validation auc = 0.731380
 20%|████████████████▌                                                                  | 6/30 [00:04<00:19,  1.25it/s]Epoch 6
                                                                                                                       Loss = 2.0979e-01, PNorm = 34.2400, GNorm = 0.3103, lr_0 = 6.7386e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.76it/s]Loss = 2.2208e-01, PNorm = 34.2781, GNorm = 0.2473, lr_0 = 6.3791e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.96it/s]Validation auc = 0.750916
 23%|███████████████████▎                                                               | 7/30 [00:05<00:18,  1.25it/s]Epoch 7
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.82it/s]Validation auc = 0.754579
 27%|██████████████████████▏                                                            | 8/30 [00:06<00:17,  1.26it/s]Epoch 8
                                                                                                                       Loss = 1.7510e-01, PNorm = 34.3440, GNorm = 0.2556, lr_0 = 5.7167e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.2263e-01, PNorm = 34.3764, GNorm = 0.3506, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.84it/s]Validation auc = 0.770452
 30%|████████████████████████▉                                                          | 9/30 [00:07<00:16,  1.25it/s]Epoch 9
                                                                                                                       Loss = 1.8643e-01, PNorm = 34.4269, GNorm = 0.2365, lr_0 = 5.1230e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.27it/s]
 33%|███████████████████████████▎                                                      | 10/30 [00:08<00:15,  1.25it/s]Epoch 10
                                                                                                                       Loss = 3.2761e-01, PNorm = 34.4623, GNorm = 0.6645, lr_0 = 4.8497e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.7190e-01, PNorm = 34.5099, GNorm = 0.2388, lr_0 = 4.5910e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 23.10it/s]Validation auc = 0.772894
 37%|██████████████████████████████                                                    | 11/30 [00:08<00:15,  1.24it/s]Epoch 11
                                                                                                                       Loss = 2.3505e-01, PNorm = 34.5471, GNorm = 0.5293, lr_0 = 4.3461e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 20.75it/s]Loss = 1.6097e-01, PNorm = 34.6022, GNorm = 0.5575, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 20.53it/s]Validation auc = 0.793651
 40%|████████████████████████████████▊                                                 | 12/30 [00:09<00:14,  1.20it/s]Epoch 12
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.29it/s]Validation auc = 0.777778
 43%|███████████████████████████████████▌                                              | 13/30 [00:10<00:13,  1.22it/s]Epoch 13
                                                                                                                       Loss = 1.4622e-01, PNorm = 34.6781, GNorm = 0.2088, lr_0 = 3.6869e-04
 12%|██████████▍                                                                        | 2/16 [00:00<00:00, 19.01it/s]Loss = 1.7050e-01, PNorm = 34.7182, GNorm = 0.3277, lr_0 = 3.4903e-04
 62%|███████████████████████████████████████████████████▎                              | 10/16 [00:00<00:00, 20.64it/s]Validation auc = 0.792430
 47%|██████████████████████████████████████▎                                           | 14/30 [00:11<00:13,  1.22it/s]Epoch 14
                                                                                                                       Loss = 1.8310e-01, PNorm = 34.7502, GNorm = 1.2681, lr_0 = 3.3041e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.10it/s]
 50%|█████████████████████████████████████████                                         | 15/30 [00:12<00:12,  1.21it/s]Epoch 15
                                                                                                                       Loss = 2.2718e-01, PNorm = 34.7766, GNorm = 0.6081, lr_0 = 3.1278e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5743e-01, PNorm = 34.8183, GNorm = 0.6959, lr_0 = 2.9609e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 20.90it/s]Validation auc = 0.776557
 53%|███████████████████████████████████████████▋                                      | 16/30 [00:13<00:11,  1.22it/s]Epoch 16
                                                                                                                       Loss = 1.3812e-01, PNorm = 34.8414, GNorm = 1.3505, lr_0 = 2.8030e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.54it/s]Loss = 1.7993e-01, PNorm = 34.8753, GNorm = 0.7405, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.07it/s]Validation auc = 0.798535
 57%|██████████████████████████████████████████████▍                                   | 17/30 [00:13<00:10,  1.23it/s]Epoch 17
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.62it/s]Validation auc = 0.796093
 60%|█████████████████████████████████████████████████▏                                | 18/30 [00:14<00:09,  1.26it/s]Epoch 18
                                                                                                                       Loss = 1.2590e-01, PNorm = 34.9244, GNorm = 0.1974, lr_0 = 2.3779e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.6539e-01, PNorm = 34.9449, GNorm = 0.4699, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.56it/s]Validation auc = 0.785104
 63%|███████████████████████████████████████████████████▉                              | 19/30 [00:15<00:08,  1.27it/s]Epoch 19
                                                                                                                       Loss = 1.7182e-01, PNorm = 34.9658, GNorm = 0.3572, lr_0 = 2.1309e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.69it/s]
 67%|██████████████████████████████████████████████████████▋                           | 20/30 [00:16<00:07,  1.29it/s]Epoch 20
                                                                                                                       Loss = 2.1987e-01, PNorm = 34.9953, GNorm = 1.2118, lr_0 = 2.0173e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.4468e-01, PNorm = 35.0161, GNorm = 0.6348, lr_0 = 1.9096e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 23.36it/s]Validation auc = 0.794872
 70%|█████████████████████████████████████████████████████████▍                        | 21/30 [00:16<00:06,  1.30it/s]Epoch 21
                                                                                                                       Loss = 1.4840e-01, PNorm = 35.0356, GNorm = 0.3357, lr_0 = 1.8078e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.71it/s]Loss = 1.3282e-01, PNorm = 35.0569, GNorm = 1.2572, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.00it/s]Validation auc = 0.789988
 73%|████████████████████████████████████████████████████████████▏                     | 22/30 [00:17<00:06,  1.31it/s]Epoch 22
                                                                                                                       Loss = 1.5248e-01, PNorm = 35.0733, GNorm = 0.6999, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.18it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 23/30 [00:18<00:05,  1.31it/s]Epoch 23
                                                                                                                       Loss = 1.4407e-01, PNorm = 35.0942, GNorm = 0.9838, lr_0 = 1.5336e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.3373e-01, PNorm = 35.1098, GNorm = 1.1699, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.82it/s]Validation auc = 0.783883
 80%|█████████████████████████████████████████████████████████████████▌                | 24/30 [00:19<00:04,  1.31it/s]Epoch 24
                                                                                                                       Loss = 1.3106e-01, PNorm = 35.1298, GNorm = 0.8322, lr_0 = 1.3743e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.30it/s]Validation auc = 0.787546
 83%|████████████████████████████████████████████████████████████████████▎             | 25/30 [00:19<00:03,  1.31it/s]Epoch 25
                                                                                                                       Loss = 7.8785e-02, PNorm = 35.1485, GNorm = 0.6990, lr_0 = 1.3010e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.86it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 26/30 [00:20<00:03,  1.32it/s]Epoch 26
                                                                                                                       Loss = 1.5080e-01, PNorm = 35.1766, GNorm = 0.5331, lr_0 = 1.1659e-04
 12%|██████████▍                                                                        | 2/16 [00:00<00:01, 10.13it/s]Loss = 1.2337e-01, PNorm = 35.1868, GNorm = 1.6517, lr_0 = 1.1037e-04
 88%|███████████████████████████████████████████████████████████████████████▊          | 14/16 [00:00<00:00, 20.67it/s]Validation auc = 0.789988
 90%|█████████████████████████████████████████████████████████████████████████▊        | 27/30 [00:21<00:02,  1.25it/s]Epoch 27
                                                                                                                       Loss = 1.2938e-01, PNorm = 35.1985, GNorm = 0.3637, lr_0 = 1.0448e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.14it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.46it/s]
Loading pretrained parameter "readout.1.bias".██████████████████████████████████████▎  | 29/30 [00:23<00:00,  1.25it/s]Epoch 29
                                                                                                                       Loss = 1.4330e-01, PNorm = 35.2328, GNorm = 0.4047, lr_0 = 1.0000e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.20it/s]Validation auc = 0.791209
100%|██████████████████████████████████████████████████████████████████████████████████| 30/30 [00:23<00:00,  1.26it/s]
Model 0 best validation auc = 0.798535 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".██████████████████████████████████████▎  | 29/30 [00:23<00:00,  1.25it/s]Epoch 29
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.913684
Ensemble test auc = 0.913684
5-fold cross validation
	Seed 0 ==> test auc = 0.924399
	Seed 1 ==> test auc = 0.839674
	Seed 2 ==> test auc = 0.778947
	Seed 3 ==> test auc = 0.869432
	Seed 4 ==> test auc = 0.913684
Overall test auc = 0.865227 +/- 0.052847
Elapsed time = 0:02:40