Fold 2
Splitting data with seed 2
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                      | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                  Loss = 4.1682e-01, PNorm = 34.0248, GNorm = 0.2797, lr_0 = 4.3000e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.22it/s]Validation auc = 0.446735
Validation binary_cross_entropy = 0.136515
  3%|███▋                                                                                                          | 1/30 [00:00<00:23,  1.25it/s]Epoch 1
                                                                                                                                                  Loss = 2.5089e-01, PNorm = 34.0451, GNorm = 0.1776, lr_0 = 7.6000e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.16it/s]Loss = 2.4552e-01, PNorm = 34.0725, GNorm = 0.3768, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.54it/s]Validation auc = 0.560137
Validation binary_cross_entropy = 0.156733
  7%|███████▎                                                                                                      | 2/30 [00:01<00:22,  1.26it/s]Epoch 2
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.79it/s]
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.08it/s]Validation auc = 0.656357
Validation binary_cross_entropy = 0.161839
 10%|███████████                                                                                                   | 3/30 [00:02<00:21,  1.26it/s]Epoch 3
                                                                                                                                                  Loss = 2.2129e-01, PNorm = 34.1169, GNorm = 0.4595, lr_0 = 8.8638e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.2529e-01, PNorm = 34.1408, GNorm = 0.3756, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.31it/s]Validation auc = 0.714777
Validation binary_cross_entropy = 0.169418
 13%|██████████████▋                                                                                               | 4/30 [00:03<00:20,  1.26it/s]Epoch 4
                                                                                                                                                  Loss = 2.5237e-01, PNorm = 34.1740, GNorm = 0.1874, lr_0 = 7.9433e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.38it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.66it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.158086
 17%|██████████████████▎                                                                                           | 5/30 [00:03<00:20,  1.25it/s]Epoch 5
                                                                                                                                                  Loss = 2.4327e-01, PNorm = 34.1957, GNorm = 0.2164, lr_0 = 7.5195e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.6348e-01, PNorm = 34.2327, GNorm = 0.0838, lr_0 = 7.1184e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.08it/s]Validation auc = 0.725086
Validation binary_cross_entropy = 0.136564
 20%|██████████████████████                                                                                        | 6/30 [00:04<00:19,  1.26it/s]Epoch 6
                                                                                                                                                  Loss = 2.3333e-01, PNorm = 34.2713, GNorm = 0.3546, lr_0 = 6.7386e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.51it/s]Loss = 2.1684e-01, PNorm = 34.3079, GNorm = 0.3004, lr_0 = 6.3791e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.70it/s]Validation auc = 0.780069
Validation binary_cross_entropy = 0.129510
 23%|█████████████████████████▋                                                                                    | 7/30 [00:05<00:18,  1.26it/s]Epoch 7
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.98it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.98it/s]Validation auc = 0.800687
Validation binary_cross_entropy = 0.151799
 27%|█████████████████████████████▎                                                                                | 8/30 [00:06<00:17,  1.26it/s]Epoch 8
                                                                                                                                                  Loss = 2.5599e-01, PNorm = 34.3835, GNorm = 0.1552, lr_0 = 5.7167e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.1236e-01, PNorm = 34.4253, GNorm = 1.0485, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.72it/s]Validation auc = 0.810997
Validation binary_cross_entropy = 0.194048
 30%|█████████████████████████████████                                                                             | 9/30 [00:07<00:17,  1.23it/s]Epoch 9
                                                                                                                                                  Loss = 2.2965e-01, PNorm = 34.4633, GNorm = 0.4746, lr_0 = 5.1230e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.56it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.66it/s]
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.131598
 33%|████████████████████████████████████▎                                                                        | 10/30 [00:08<00:16,  1.23it/s]Epoch 10
                                                                                                                                                  Loss = 3.5988e-01, PNorm = 34.4850, GNorm = 0.7213, lr_0 = 4.8497e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0087e-01, PNorm = 34.5228, GNorm = 1.1308, lr_0 = 4.5910e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.76it/s]Validation auc = 0.831615
Validation binary_cross_entropy = 0.151214
 37%|███████████████████████████████████████▉                                                                     | 11/30 [00:08<00:15,  1.22it/s]Epoch 11
                                                                                                                                                  Loss = 1.8528e-01, PNorm = 34.5573, GNorm = 0.3105, lr_0 = 4.3461e-04
 12%|█████████████▊                                                                                                | 2/16 [00:00<00:00, 19.50it/s]Loss = 2.0522e-01, PNorm = 34.5827, GNorm = 0.3337, lr_0 = 4.1142e-04
 88%|███████████████████████████████████████████████████████████████████████████████████████████████▍             | 14/16 [00:00<00:00, 21.63it/s]Validation auc = 0.865979
Validation binary_cross_entropy = 0.134689
 40%|███████████████████████████████████████████▌                                                                 | 12/30 [00:09<00:14,  1.22it/s]Epoch 12
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.02it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.74it/s]Validation auc = 0.907216
Validation binary_cross_entropy = 0.106164
 43%|███████████████████████████████████████████████▏                                                             | 13/30 [00:10<00:13,  1.23it/s]Epoch 13
                                                                                                                                                  Loss = 2.1237e-01, PNorm = 34.6519, GNorm = 0.3464, lr_0 = 3.6869e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.8352e-01, PNorm = 34.6852, GNorm = 0.8627, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.27it/s]Validation auc = 0.914089
Validation binary_cross_entropy = 0.111741
 47%|██████████████████████████████████████████████████▊                                                          | 14/30 [00:11<00:13,  1.22it/s]Epoch 14
                                                                                                                                                  Loss = 1.7643e-01, PNorm = 34.7158, GNorm = 0.4892, lr_0 = 3.3041e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.53it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.93it/s]
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.150722
 50%|██████████████████████████████████████████████████████▌                                                      | 15/30 [00:12<00:12,  1.25it/s]Epoch 15
                                                                                                                                                  Loss = 2.1706e-01, PNorm = 34.7413, GNorm = 0.7743, lr_0 = 3.1278e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.9433e-01, PNorm = 34.7765, GNorm = 2.1209, lr_0 = 2.9609e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.22it/s]Validation auc = 0.890034
Validation binary_cross_entropy = 0.141340
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:12<00:11,  1.27it/s]Epoch 16
                                                                                                                                                  Loss = 1.9754e-01, PNorm = 34.8135, GNorm = 0.8259, lr_0 = 2.8030e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 20.70it/s]Loss = 1.7337e-01, PNorm = 34.8375, GNorm = 1.3376, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.58it/s]Validation auc = 0.910653
Validation binary_cross_entropy = 0.116563
 57%|█████████████████████████████████████████████████████████████▊                                               | 17/30 [00:13<00:10,  1.28it/s]Epoch 17
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.70it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.84it/s]Validation auc = 0.917526
Validation binary_cross_entropy = 0.102900
 60%|█████████████████████████████████████████████████████████████████▍                                           | 18/30 [00:14<00:09,  1.28it/s]Epoch 18
                                                                                                                                                  Loss = 1.6132e-01, PNorm = 34.8876, GNorm = 1.0371, lr_0 = 2.3779e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7927e-01, PNorm = 34.9121, GNorm = 1.0660, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.08it/s]Validation auc = 0.927835
Validation binary_cross_entropy = 0.101701
 63%|█████████████████████████████████████████████████████████████████████                                        | 19/30 [00:15<00:08,  1.27it/s]Epoch 19
                                                                                                                                                  Loss = 1.6529e-01, PNorm = 34.9370, GNorm = 0.6017, lr_0 = 2.1309e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.84it/s]Validation auc = 0.917526
Validation binary_cross_entropy = 0.107912
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:15<00:07,  1.28it/s]Epoch 20
                                                                                                                                                  Loss = 1.2439e-01, PNorm = 34.9628, GNorm = 0.5934, lr_0 = 2.0173e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.4924e-01, PNorm = 34.9974, GNorm = 0.2846, lr_0 = 1.9096e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.27it/s]Validation auc = 0.903780
Validation binary_cross_entropy = 0.104834
 70%|████████████████████████████████████████████████████████████████████████████▎                                | 21/30 [00:16<00:06,  1.29it/s]Epoch 21
                                                                                                                                                  Loss = 1.9348e-01, PNorm = 34.9997, GNorm = 2.8249, lr_0 = 1.8078e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.43it/s]Loss = 1.9669e-01, PNorm = 35.0275, GNorm = 3.4270, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.70it/s]Validation auc = 0.914089
Validation binary_cross_entropy = 0.101365
 73%|███████████████████████████████████████████████████████████████████████████████▉                             | 22/30 [00:17<00:06,  1.30it/s]Epoch 22
                                                                                                                                                  Loss = 1.6496e-01, PNorm = 35.0365, GNorm = 0.4002, lr_0 = 1.6200e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.36it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.92it/s]
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.4924e-01, PNorm = 34.9974, GNorm = 0.2846, lr_0 = 1.9096e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.1057e-01, PNorm = 35.0562, GNorm = 0.6784, lr_0 = 1.5336e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.5744e-01, PNorm = 35.0645, GNorm = 0.6376, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.02it/s]Validation auc = 0.910653
Validation binary_cross_entropy = 0.123861
 80%|███████████████████████████████████████████████████████████████████████████████████████▏                     | 24/30 [00:19<00:04,  1.28it/s]Epoch 24
                                                                                                                                                  Loss = 1.3278e-01, PNorm = 35.0833, GNorm = 0.8744, lr_0 = 1.3743e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.37it/s]Validation auc = 0.903780
Validation binary_cross_entropy = 0.134523
 83%|██████████████████████████████████████████████████████████████████████████████████████████▊                  | 25/30 [00:19<00:04,  1.22it/s]Epoch 25
                                                                                                                                                  Loss = 1.5884e-01, PNorm = 35.0888, GNorm = 1.2978, lr_0 = 1.3010e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 12%|█████████████▊                                                                                                | 2/16 [00:00<00:00, 19.68it/s]
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.1057e-01, PNorm = 35.0562, GNorm = 0.6784, lr_0 = 1.5336e-04
auc
binary_cross_entropy
auc
 87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 26/30 [00:20<00:03,  1.23it/s]Epoch 26.1057e-01, PNorm = 35.0562, GNorm = 0.6784, lr_0 = 1.5336e-04
                                                                                                                                                  Loss = 1.3241e-01, PNorm = 35.1151, GNorm = 0.5916, lr_0 = 1.1659e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.62it/s]Loss = 1.7148e-01, PNorm = 35.1305, GNorm = 0.3931, lr_0 = 1.1037e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.94it/s]Validation auc = 0.907216
Validation binary_cross_entropy = 0.108970
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:21<00:02,  1.25it/s]Epoch 27
                                                                                                                                                  Loss = 1.5145e-01, PNorm = 35.1414, GNorm = 0.8061, lr_0 = 1.0448e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.60it/s]
 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 15/16 [00:00<00:00, 22.45it/s]
 87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 26/30 [00:20<00:03,  1.23it/s]Epoch 26.1057e-01, PNorm = 35.0562, GNorm = 0.6784, lr_0 = 1.5336e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Loading pretrained parameter "readout.1.bias".                                                                                                    Epoch 26.1057e-01, PNorm = 35.0562, GNorm = 0.6784, lr_0 = 1.5336e-04
 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 29/30 [00:23<00:00,  1.28it/s]Epoch 29
                                                                                                                                                  Loss = 1.1435e-01, PNorm = 35.1759, GNorm = 0.3711, lr_0 = 1.0000e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.87it/s]Validation auc = 0.914089
Validation binary_cross_entropy = 0.119049
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:23<00:00,  1.26it/s]
Model 0 best validation auc = 0.927835 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".                                                                                                    Epoch 26.1057e-01, PNorm = 35.0562, GNorm = 0.6784, lr_0 = 1.5336e-04
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.776842
Model 0 test binary_cross_entropy = 0.179619
Ensemble test auc = 0.776842
Ensemble test binary_cross_entropy = 0.179619
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy