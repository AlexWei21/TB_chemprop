Fold 1
Splitting data with seed 1
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                      | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                  Loss = 4.0233e-01, PNorm = 34.0252, GNorm = 0.5390, lr_0 = 4.3000e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.93it/s]Validation auc = 0.450077
Validation binary_cross_entropy = 0.300441
  3%|███▋                                                                                                          | 1/30 [00:00<00:22,  1.27it/s]Epoch 1
                                                                                                                                                  Loss = 1.4296e-01, PNorm = 34.0476, GNorm = 0.4083, lr_0 = 7.6000e-04
 12%|█████████████▊                                                                                                | 2/16 [00:00<00:00, 18.95it/s]Loss = 2.6266e-01, PNorm = 34.0790, GNorm = 0.2813, lr_0 = 9.8910e-04
 88%|███████████████████████████████████████████████████████████████████████████████████████████████▍             | 14/16 [00:00<00:00, 21.15it/s]Validation auc = 0.589862
Validation binary_cross_entropy = 0.258246
auc
binary_cross_entropy
auc
binary_cross_entropy
  7%|███████▎                                                                                                      | 2/30 [00:01<00:25,  1.12it/s]Epoch 2
                                                                                                                                                  Loss = 1.9483e-01, PNorm = 34.1037, GNorm = 0.2031, lr_0 = 9.3633e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.07it/s]Validation auc = 0.586790
Validation binary_cross_entropy = 0.251689
 10%|███████████                                                                                                   | 3/30 [00:02<00:22,  1.17it/s]Epoch 3
                                                                                                                                                  Loss = 1.9411e-01, PNorm = 34.1216, GNorm = 0.7690, lr_0 = 8.8638e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.7169e-01, PNorm = 34.1417, GNorm = 0.5520, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.35it/s]Validation auc = 0.582181
Validation binary_cross_entropy = 0.259323
 13%|██████████████▋                                                                                               | 4/30 [00:03<00:21,  1.21it/s]Epoch 4
                                                                                                                                                  Loss = 1.8834e-01, PNorm = 34.1749, GNorm = 0.0662, lr_0 = 7.9433e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.09it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.16it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.246424
 17%|██████████████████▎                                                                                           | 5/30 [00:04<00:20,  1.23it/s]Epoch 5
                                                                                                                                                  Loss = 2.0918e-01, PNorm = 34.1843, GNorm = 0.1685, lr_0 = 7.5195e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0765e-01, PNorm = 34.2158, GNorm = 0.2001, lr_0 = 7.1184e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.56it/s]Validation auc = 0.594470
Validation binary_cross_entropy = 0.252980
 20%|██████████████████████                                                                                        | 6/30 [00:04<00:19,  1.24it/s]Epoch 6
                                                                                                                                                  Loss = 2.2811e-01, PNorm = 34.2396, GNorm = 0.3248, lr_0 = 6.7386e-04
 25%|███████████████████████████▌                                                                                  | 4/16 [00:00<00:00, 19.70it/s]Loss = 2.0143e-01, PNorm = 34.2792, GNorm = 0.1407, lr_0 = 6.3791e-04
 81%|████████████████████████████████████████████████████████████████████████████████████████▌                    | 13/16 [00:00<00:00, 21.52it/s]Validation auc = 0.589862
Validation binary_cross_entropy = 0.261218
 23%|█████████████████████████▋                                                                                    | 7/30 [00:05<00:18,  1.24it/s]Epoch 7
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.34it/s]Validation auc = 0.591398
Validation binary_cross_entropy = 0.277876
 27%|█████████████████████████████▎                                                                                | 8/30 [00:06<00:17,  1.24it/s]Epoch 8
                                                                                                                                                  Loss = 2.4626e-01, PNorm = 34.3536, GNorm = 0.5112, lr_0 = 5.7167e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0544e-01, PNorm = 34.3742, GNorm = 0.4080, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.46it/s]Validation auc = 0.612903
Validation binary_cross_entropy = 0.252160
 30%|█████████████████████████████████                                                                             | 9/30 [00:07<00:17,  1.21it/s]Epoch 9
                                                                                                                                                  Loss = 2.1134e-01, PNorm = 34.4188, GNorm = 0.7204, lr_0 = 5.1230e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.69it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.77it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.252504
 33%|████████████████████████████████████▎                                                                        | 10/30 [00:08<00:16,  1.22it/s]Epoch 10
                                                                                                                                                  Loss = 1.6474e-01, PNorm = 34.4551, GNorm = 0.2646, lr_0 = 4.8497e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.9624e-01, PNorm = 34.4880, GNorm = 0.1819, lr_0 = 4.5910e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.93it/s]Validation auc = 0.603687
Validation binary_cross_entropy = 0.258655
 37%|███████████████████████████████████████▉                                                                     | 11/30 [00:08<00:15,  1.26it/s]Epoch 11
                                                                                                                                                  Loss = 1.6284e-01, PNorm = 34.5252, GNorm = 0.1835, lr_0 = 4.3461e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.86it/s]Loss = 2.2766e-01, PNorm = 34.5540, GNorm = 0.2993, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.79it/s]Validation auc = 0.615975
Validation binary_cross_entropy = 0.252437
 40%|███████████████████████████████████████████▌                                                                 | 12/30 [00:09<00:14,  1.26it/s]Epoch 12
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.13it/s]
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.91it/s]Validation auc = 0.602151
Validation binary_cross_entropy = 0.264170
 43%|███████████████████████████████████████████████▏                                                             | 13/30 [00:10<00:13,  1.28it/s]Epoch 13
                                                                                                                                                  Loss = 1.2148e-01, PNorm = 34.6358, GNorm = 0.2726, lr_0 = 3.6869e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.9985e-01, PNorm = 34.6531, GNorm = 0.3371, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.38it/s]Validation auc = 0.646697
Validation binary_cross_entropy = 0.250701
 47%|██████████████████████████████████████████████████▊                                                          | 14/30 [00:11<00:12,  1.27it/s]Epoch 14
                                                                                                                                                  Loss = 2.0209e-01, PNorm = 34.6906, GNorm = 0.1399, lr_0 = 3.3041e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.96it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.79it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.262709
 50%|██████████████████████████████████████████████████████▌                                                      | 15/30 [00:12<00:11,  1.27it/s]Epoch 15
                                                                                                                                                  Loss = 3.1569e-01, PNorm = 34.7285, GNorm = 0.8887, lr_0 = 3.1278e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.5826e-01, PNorm = 34.7596, GNorm = 0.4369, lr_0 = 2.9609e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.14it/s]Validation auc = 0.678955
Validation binary_cross_entropy = 0.246787
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:12<00:11,  1.27it/s]Epoch 16
                                                                                                                                                  Loss = 1.7222e-01, PNorm = 34.7888, GNorm = 0.5481, lr_0 = 2.8030e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.49it/s]Loss = 1.6737e-01, PNorm = 34.8315, GNorm = 0.4047, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.80it/s]Validation auc = 0.689708
Validation binary_cross_entropy = 0.261891
 57%|█████████████████████████████████████████████████████████████▊                                               | 17/30 [00:13<00:10,  1.26it/s]Epoch 17
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.75it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.23it/s]Validation auc = 0.721966
Validation binary_cross_entropy = 0.303873
 60%|█████████████████████████████████████████████████████████████████▍                                           | 18/30 [00:14<00:09,  1.28it/s]Epoch 18
                                                                                                                                                  Loss = 1.5435e-01, PNorm = 34.9005, GNorm = 1.1730, lr_0 = 2.3779e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.9345e-01, PNorm = 34.9055, GNorm = 1.1276, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.13it/s]Validation auc = 0.723502
Validation binary_cross_entropy = 0.238903
 63%|█████████████████████████████████████████████████████████████████████                                        | 19/30 [00:15<00:08,  1.27it/s]Epoch 19
                                                                                                                                                  Loss = 1.7419e-01, PNorm = 34.9462, GNorm = 0.9925, lr_0 = 2.1309e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.23it/s]Validation auc = 0.721966
Validation binary_cross_entropy = 0.237236
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:15<00:07,  1.29it/s]Epoch 20
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.8304e-01, PNorm = 34.9844, GNorm = 0.5674, lr_0 = 1.9096e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 21.39it/s]Validation auc = 0.734255
Validation binary_cross_entropy = 0.240013
 70%|████████████████████████████████████████████████████████████████████████████▎                                | 21/30 [00:16<00:07,  1.26it/s]Epoch 21
                                                                                                                                                  Loss = 1.4589e-01, PNorm = 35.0120, GNorm = 0.5960, lr_0 = 1.8078e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 21.67it/s]Loss = 1.4719e-01, PNorm = 35.0255, GNorm = 0.3373, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.62it/s]Validation auc = 0.726575
Validation binary_cross_entropy = 0.245717
 73%|███████████████████████████████████████████████████████████████████████████████▉                             | 22/30 [00:17<00:06,  1.26it/s]Epoch 22
                                                                                                                                                  Loss = 1.4879e-01, PNorm = 35.0540, GNorm = 0.4244, lr_0 = 1.6200e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.34it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.36it/s]
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.8304e-01, PNorm = 34.9844, GNorm = 0.5674, lr_0 = 1.9096e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.2847e-01, PNorm = 35.0631, GNorm = 0.5671, lr_0 = 1.5336e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.5462e-01, PNorm = 35.0885, GNorm = 0.5005, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.85it/s]Validation auc = 0.748080
Validation binary_cross_entropy = 0.244550
 80%|███████████████████████████████████████████████████████████████████████████████████████▏                     | 24/30 [00:19<00:04,  1.25it/s]Epoch 24
                                                                                                                                                  Loss = 1.6066e-01, PNorm = 35.1052, GNorm = 0.4984, lr_0 = 1.3743e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.45it/s]Validation auc = 0.752688
Validation binary_cross_entropy = 0.239442
 83%|██████████████████████████████████████████████████████████████████████████████████████████▊                  | 25/30 [00:19<00:03,  1.28it/s]Epoch 25
                                                                                                                                                  Loss = 1.2829e-01, PNorm = 35.1217, GNorm = 0.2779, lr_0 = 1.3010e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.2847e-01, PNorm = 35.0631, GNorm = 0.5671, lr_0 = 1.5336e-04
auc
binary_cross_entropy
auc
 87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 26/30 [00:20<00:03,  1.29it/s]Epoch 26.2847e-01, PNorm = 35.0631, GNorm = 0.5671, lr_0 = 1.5336e-04
                                                                                                                                                  Loss = 1.2449e-01, PNorm = 35.1588, GNorm = 0.4747, lr_0 = 1.1659e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.44it/s]Loss = 1.4467e-01, PNorm = 35.1663, GNorm = 0.4328, lr_0 = 1.1037e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.05it/s]Validation auc = 0.760369
Validation binary_cross_entropy = 0.236652
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:21<00:02,  1.23it/s]Epoch 27
                                                                                                                                                  Loss = 1.1115e-01, PNorm = 35.1880, GNorm = 0.4678, lr_0 = 1.0448e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.35it/s]
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.41it/s]
 87%|██████████████████████████████████████████████████████████████████████████████████████████████▍              | 26/30 [00:20<00:03,  1.29it/s]Epoch 26.2847e-01, PNorm = 35.0631, GNorm = 0.5671, lr_0 = 1.5336e-04
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Loading pretrained parameter "readout.1.bias".                                                                                                    Epoch 26.2847e-01, PNorm = 35.0631, GNorm = 0.5671, lr_0 = 1.5336e-04
 97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 29/30 [00:23<00:00,  1.25it/s]Epoch 29
                                                                                                                                                  Loss = 1.4522e-01, PNorm = 35.2233, GNorm = 0.5568, lr_0 = 1.0000e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.92it/s]Validation auc = 0.763441
Validation binary_cross_entropy = 0.246574
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:23<00:00,  1.25it/s]
Model 0 best validation auc = 0.763441 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".                                                                                                    Epoch 26.2847e-01, PNorm = 35.0631, GNorm = 0.5671, lr_0 = 1.5336e-04
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.839674
Model 0 test binary_cross_entropy = 0.222752
Ensemble test auc = 0.839674
Ensemble test binary_cross_entropy = 0.222752
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy