                                                                                                                       Loss = 3.9459e-01, PNorm = 34.0258, GNorm = 0.6065, lr_0 = 4.3000e-04
 50%|█████████████████████████████████████████▌                                         | 8/16 [00:00<00:00, 14.76it/s]Validation auc = 0.513587
Epoch 1
                                                                                                                       Loss = 2.4347e-01, PNorm = 34.0446, GNorm = 0.1529, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 20.49it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 21.50it/s]Validation auc = 0.796196
Epoch 2
                                                                                                                       Loss = 2.6228e-01, PNorm = 34.0985, GNorm = 0.5418, lr_0 = 9.3633e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.23it/s]Validation auc = 0.832880
Epoch 3
                                                                                                                       Loss = 3.1523e-01, PNorm = 34.1221, GNorm = 0.2295, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.3547e-01, PNorm = 34.1458, GNorm = 0.4104, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 19.95it/s]Validation auc = 0.846467
Epoch 4
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 20.70it/s]Validation auc = 0.853261
Epoch 5
                                                                                                                       Loss = 2.3182e-01, PNorm = 34.2039, GNorm = 0.2481, lr_0 = 7.5195e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.3869e-01, PNorm = 34.2303, GNorm = 0.2333, lr_0 = 7.1184e-04
 50%|█████████████████████████████████████████▌                                         | 8/16 [00:00<00:00, 20.92it/s]Validation auc = 0.861413
Epoch 6
                                                                                                                       Loss = 2.2357e-01, PNorm = 34.2637, GNorm = 0.2625, lr_0 = 6.7386e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 19.84it/s]
 88%|███████████████████████████████████████████████████████████████████████▊          | 14/16 [00:00<00:00, 20.01it/s]Validation auc = 0.861413
Epoch 7
                                                                                                                       Loss = 2.0284e-01, PNorm = 34.3417, GNorm = 0.1107, lr_0 = 6.0388e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.91it/s]Validation auc = 0.873641
Epoch 8
                                                                                                                       Loss = 1.7750e-01, PNorm = 34.3777, GNorm = 0.3677, lr_0 = 5.7167e-04
 12%|██████████▍                                                                        | 2/16 [00:00<00:00, 17.77it/s]Loss = 2.3323e-01, PNorm = 34.4310, GNorm = 0.6935, lr_0 = 5.4117e-04
 62%|███████████████████████████████████████████████████▎                              | 10/16 [00:00<00:00, 21.43it/s]
Epoch 9
                                                                                                                       Loss = 2.1908e-01, PNorm = 34.4698, GNorm = 0.2545, lr_0 = 5.1230e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.14it/s]Validation auc = 0.885870
Epoch 10
                                                                                                                       Loss = 1.2023e-01, PNorm = 34.5227, GNorm = 0.1335, lr_0 = 4.8497e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.0841e-01, PNorm = 34.5590, GNorm = 0.2257, lr_0 = 4.5910e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.65it/s]Validation auc = 0.883152
Epoch 11
                                                                                                                       Loss = 1.9376e-01, PNorm = 34.6173, GNorm = 0.4570, lr_0 = 4.3461e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.36it/s]Loss = 1.9734e-01, PNorm = 34.6551, GNorm = 0.2772, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.17it/s]Validation auc = 0.881793
Epoch 12
                                                                                                                       Loss = 1.8073e-01, PNorm = 34.7059, GNorm = 0.6232, lr_0 = 3.8947e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.50it/s]Validation auc = 0.892663
Epoch 13
                                                                                                                       Loss = 1.7008e-01, PNorm = 34.7454, GNorm = 0.2562, lr_0 = 3.6869e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.9513e-01, PNorm = 34.7863, GNorm = 1.1113, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.36it/s]
Epoch 14
                                                                                                                       Loss = 1.8852e-01, PNorm = 34.8303, GNorm = 0.4751, lr_0 = 3.3041e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 22.01it/s]Validation auc = 0.902174
Epoch 15
                                                                                                                       Loss = 1.7902e-01, PNorm = 34.8669, GNorm = 0.5034, lr_0 = 3.1278e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.7460e-01, PNorm = 34.8995, GNorm = 0.8160, lr_0 = 2.9609e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.33it/s]Validation auc = 0.908967
Epoch 16
                                                                                                                       Loss = 1.3552e-01, PNorm = 34.9356, GNorm = 0.4730, lr_0 = 2.8030e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.76it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.09it/s]Validation auc = 0.910326
Epoch 17
                                                                                                                       Loss = 1.5895e-01, PNorm = 34.9988, GNorm = 1.4835, lr_0 = 2.5119e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.91it/s]Validation auc = 0.914402
Epoch 18
                                                                                                                       Loss = 2.0720e-01, PNorm = 35.0357, GNorm = 1.3303, lr_0 = 2.3779e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5008e-01, PNorm = 35.0694, GNorm = 0.5733, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.23it/s]
Epoch 19
                                                                                                                       Loss = 1.4898e-01, PNorm = 35.0869, GNorm = 0.8557, lr_0 = 2.1309e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.70it/s]Validation auc = 0.913043
Epoch 20
                                                                                                                       Loss = 5.4106e-02, PNorm = 35.1095, GNorm = 0.5726, lr_0 = 2.0173e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.6033e-01, PNorm = 35.1345, GNorm = 0.6707, lr_0 = 1.9096e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.61it/s]Validation auc = 0.918478
Epoch 21
                                                                                                                       Loss = 1.5642e-01, PNorm = 35.1557, GNorm = 0.8067, lr_0 = 1.8078e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.27it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.15it/s]Validation auc = 0.914402
Epoch 22
                                                                                                                       Loss = 1.5335e-01, PNorm = 35.2033, GNorm = 1.9327, lr_0 = 1.6200e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.48it/s]Validation auc = 0.917120
Epoch 23
                                                                                                                       Loss = 1.1996e-01, PNorm = 35.2189, GNorm = 0.4467, lr_0 = 1.5336e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.4929e-01, PNorm = 35.2387, GNorm = 2.5123, lr_0 = 1.4518e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.20it/s]Validation auc = 0.917120
Epoch 24
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 21.19it/s]Validation auc = 0.918478
Epoch 25
                                                                                                                       Loss = 1.0338e-01, PNorm = 35.2711, GNorm = 0.5957, lr_0 = 1.3010e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.2098e-01, PNorm = 35.2882, GNorm = 0.5302, lr_0 = 1.2316e-04
 50%|█████████████████████████████████████████▌                                         | 8/16 [00:00<00:00, 22.70it/s]Validation auc = 0.919837
Epoch 26
                                                                                                                       Loss = 1.3773e-01, PNorm = 35.3016, GNorm = 0.5926, lr_0 = 1.1659e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 22.84it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.22it/s]Validation auc = 0.917120
Epoch 27
                                                                                                                       Loss = 1.1913e-01, PNorm = 35.3317, GNorm = 1.0899, lr_0 = 1.0448e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.58it/s]Validation auc = 0.917120
Epoch 28
                                                                                                                       Loss = 1.1113e-01, PNorm = 35.3453, GNorm = 0.4502, lr_0 = 1.0000e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.3098e-01, PNorm = 35.3561, GNorm = 0.9798, lr_0 = 1.0000e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.57it/s]Validation auc = 0.915761
Epoch 29
                                                                                                                       Loss = 1.2817e-01, PNorm = 35.3715, GNorm = 0.9491, lr_0 = 1.0000e-04
Loading pretrained parameter "encoder.encoder.0.W_o.bias".                              | 6/16 [00:00<00:00, 23.76it/s]Validation auc = 0.915761
Model 0 best validation auc = 0.919837 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".                              | 6/16 [00:00<00:00, 23.76it/s]Validation auc = 0.915761
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.914089
Ensemble test auc = 0.914089
Fold 1
Splitting data with seed 1
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                           | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                       Loss = 4.0233e-01, PNorm = 34.0252, GNorm = 0.5390, lr_0 = 4.3000e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 22.02it/s]Validation auc = 0.450077
  3%|██▊                                                                                | 1/30 [00:00<00:23,  1.23it/s]Epoch 1
                                                                                                                       Loss = 1.4296e-01, PNorm = 34.0476, GNorm = 0.4083, lr_0 = 7.6000e-04
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.05it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.49it/s]Validation auc = 0.589862
  7%|█████▌                                                                             | 2/30 [00:01<00:22,  1.24it/s]Epoch 2
                                                                                                                       Loss = 1.9483e-01, PNorm = 34.1037, GNorm = 0.2031, lr_0 = 9.3633e-04
 38%|███████████████████████████████▏                                                   | 6/16 [00:00<00:00, 23.47it/s]Validation auc = 0.586790
 10%|████████▎                                                                          | 3/30 [00:02<00:21,  1.27it/s]Epoch 3
                                                                                                                       Loss = 1.9411e-01, PNorm = 34.1216, GNorm = 0.7690, lr_0 = 8.8638e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 2.7169e-01, PNorm = 34.1417, GNorm = 0.5520, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 23.06it/s]Validation auc = 0.582181
 13%|███████████                                                                        | 4/30 [00:03<00:20,  1.29it/s]Epoch 4
 19%|███████████████▌                                                                   | 3/16 [00:00<00:00, 23.52it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.49it/s]Validation auc = 0.589862
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.49it/s]Validation auc = 0.589862
 75%|█████████████████████████████████████████████████████████████▌                    | 12/16 [00:00<00:00, 22.49it/s]Loss = 1.6498e-01, PNorm = 34.4548, GNorm = 0.2654, lr_0 = 4.8497e-04
 43%|███████████████████████████████████▌                                              | 13/30 [00:10<00:13,  1.27it/s]Epoch 13.6498e-01, PNorm = 34.4548, GNorm = 0.2654, lr_0 = 4.8497e-04
  0%|                                                                                           | 0/16 [00:00<?, ?it/s]Loss = 1.5815e-01, PNorm = 34.7587, GNorm = 0.4172, lr_0 = 2.9609e-04
 60%|█████████████████████████████████████████████████▏                                | 18/30 [00:14<00:09,  1.27it/s]Epoch 18.5815e-01, PNorm = 34.7587, GNorm = 0.4172, lr_0 = 2.9609e-04
 56%|██████████████████████████████████████████████▋                                    | 9/16 [00:00<00:00, 21.71it/s]Validation auc = 0.732719= 34.7587, GNorm = 0.4172, lr_0 = 2.9609e-04
 77%|██████████████████████████████████████████████████████████████▊                   | 23/30 [00:18<00:05,  1.26it/s]Epoch 23on auc = 0.732719= 34.7587, GNorm = 0.4172, lr_0 = 2.9609e-04
