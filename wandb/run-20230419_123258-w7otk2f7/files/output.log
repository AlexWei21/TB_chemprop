Fold 3
Splitting data with seed 3
Class sizes
confirmed_hit 0: 93.59%, 1: 6.41%
Total size = 999 | train size = 799 | val size = 100 | test size = 100
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                      | 0/30 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                  Loss = 4.0001e-01, PNorm = 34.0252, GNorm = 0.6016, lr_0 = 4.3000e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.80it/s]Validation auc = 0.538462
Validation binary_cross_entropy = 0.346715
  3%|███▋                                                                                                          | 1/30 [00:00<00:23,  1.26it/s]Epoch 1
                                                                                                                                                  Loss = 2.1289e-01, PNorm = 34.0434, GNorm = 0.3594, lr_0 = 7.6000e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.13it/s]Loss = 2.4657e-01, PNorm = 34.0821, GNorm = 0.2382, lr_0 = 9.8910e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.94it/s]Validation auc = 0.748474
Validation binary_cross_entropy = 0.413102
  7%|███████▎                                                                                                      | 2/30 [00:01<00:22,  1.27it/s]Epoch 2
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.90it/s]
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.87it/s]Validation auc = 0.708181
Validation binary_cross_entropy = 0.300727
 10%|███████████                                                                                                   | 3/30 [00:02<00:20,  1.29it/s]Epoch 3
                                                                                                                                                  Loss = 2.5489e-01, PNorm = 34.1134, GNorm = 0.1967, lr_0 = 8.8638e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0334e-01, PNorm = 34.1259, GNorm = 0.0847, lr_0 = 8.3909e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.28it/s]Validation auc = 0.755800
Validation binary_cross_entropy = 0.281149
 13%|██████████████▋                                                                                               | 4/30 [00:03<00:20,  1.28it/s]Epoch 4
                                                                                                                                                  Loss = 2.1504e-01, PNorm = 34.1434, GNorm = 0.3732, lr_0 = 7.9433e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.02it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.35it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.282338
 17%|██████████████████▎                                                                                           | 5/30 [00:03<00:19,  1.30it/s]Epoch 5
                                                                                                                                                  Loss = 2.3654e-01, PNorm = 34.1645, GNorm = 0.2837, lr_0 = 7.5195e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7787e-01, PNorm = 34.1842, GNorm = 0.1762, lr_0 = 7.1184e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 23.40it/s]Validation auc = 0.770452
Validation binary_cross_entropy = 0.272150
 20%|██████████████████████                                                                                        | 6/30 [00:04<00:18,  1.29it/s]Epoch 6
                                                                                                                                                  Loss = 2.1811e-01, PNorm = 34.2068, GNorm = 0.5490, lr_0 = 6.7386e-04
 12%|█████████████▊                                                                                                | 2/16 [00:00<00:00, 19.61it/s]Loss = 2.1856e-01, PNorm = 34.2396, GNorm = 0.5195, lr_0 = 6.3791e-04
 88%|███████████████████████████████████████████████████████████████████████████████████████████████▍             | 14/16 [00:00<00:00, 23.12it/s]Validation auc = 0.757021
Validation binary_cross_entropy = 0.273645
 23%|█████████████████████████▋                                                                                    | 7/30 [00:05<00:17,  1.30it/s]Epoch 7
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.63it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.63it/s]Validation auc = 0.750916
Validation binary_cross_entropy = 0.276379
 27%|█████████████████████████████▎                                                                                | 8/30 [00:06<00:16,  1.30it/s]Epoch 8
                                                                                                                                                  Loss = 1.5253e-01, PNorm = 34.2997, GNorm = 0.4318, lr_0 = 5.7167e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 2.0650e-01, PNorm = 34.3254, GNorm = 0.4932, lr_0 = 5.4117e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.75it/s]Validation auc = 0.761905
Validation binary_cross_entropy = 0.268836
 30%|█████████████████████████████████                                                                             | 9/30 [00:06<00:16,  1.30it/s]Epoch 9
                                                                                                                                                  Loss = 1.9907e-01, PNorm = 34.3563, GNorm = 0.7686, lr_0 = 5.1230e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.52it/s]Validation auc = 0.747253
Validation binary_cross_entropy = 0.281570
 33%|████████████████████████████████████▎                                                                        | 10/30 [00:07<00:15,  1.30it/s]Epoch 10
                                                                                                                                                  Loss = 1.4811e-01, PNorm = 34.3835, GNorm = 0.1848, lr_0 = 4.8497e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.9928e-01, PNorm = 34.4181, GNorm = 0.1434, lr_0 = 4.5910e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.58it/s]Validation auc = 0.738706
Validation binary_cross_entropy = 0.289816
 37%|███████████████████████████████████████▉                                                                     | 11/30 [00:08<00:14,  1.30it/s]Epoch 11
                                                                                                                                                  Loss = 2.1677e-01, PNorm = 34.4436, GNorm = 0.4832, lr_0 = 4.3461e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 20.41it/s]Loss = 1.8699e-01, PNorm = 34.4834, GNorm = 0.3898, lr_0 = 4.1142e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.38it/s]Validation auc = 0.736264
Validation binary_cross_entropy = 0.289235
 40%|███████████████████████████████████████████▌                                                                 | 12/30 [00:09<00:14,  1.28it/s]Epoch 12
                                                                                                                                                  Loss = 1.7691e-01, PNorm = 34.4959, GNorm = 0.4164, lr_0 = 3.8947e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 21.08it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 20.76it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Validation binary_cross_entropy = 0.283663
 43%|███████████████████████████████████████████████▏                                                             | 13/30 [00:10<00:13,  1.26it/s]Epoch 13
                                                                                                                                                  Loss = 1.0982e-01, PNorm = 34.5343, GNorm = 0.1323, lr_0 = 3.6869e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.8920e-01, PNorm = 34.5519, GNorm = 0.2622, lr_0 = 3.4903e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.45it/s]Validation auc = 0.749695
Validation binary_cross_entropy = 0.271364
 47%|██████████████████████████████████████████████████▊                                                          | 14/30 [00:10<00:12,  1.26it/s]Epoch 14
                                                                                                                                                  Loss = 2.1401e-01, PNorm = 34.5808, GNorm = 0.2178, lr_0 = 3.3041e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.16it/s]Validation auc = 0.732601
Validation binary_cross_entropy = 0.310032
 50%|██████████████████████████████████████████████████████▌                                                      | 15/30 [00:11<00:11,  1.27it/s]Epoch 15
                                                                                                                                                  Loss = 5.8903e-02, PNorm = 34.6182, GNorm = 0.1853, lr_0 = 3.1278e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 31%|██████████████████████████████████▍                                                                           | 5/16 [00:00<00:00, 21.44it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 22.45it/s]Validation auc = 0.757021
Validation binary_cross_entropy = 0.268748
 53%|██████████████████████████████████████████████████████████▏                                                  | 16/30 [00:12<00:10,  1.28it/s]Epoch 16
                                                                                                                                                  Loss = 1.9378e-01, PNorm = 34.6670, GNorm = 0.1985, lr_0 = 2.8030e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 24.05it/s]Loss = 1.6536e-01, PNorm = 34.6865, GNorm = 0.1974, lr_0 = 2.6534e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.21it/s]Validation auc = 0.753358
Validation binary_cross_entropy = 0.271592
 57%|█████████████████████████████████████████████████████████████▊                                               | 17/30 [00:13<00:10,  1.28it/s]Epoch 17
                                                                                                                                                  Loss = 2.0266e-01, PNorm = 34.7152, GNorm = 0.5977, lr_0 = 2.5119e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.93it/s]
  0%|                                                                                                                       | 0/2 [00:00<?, ?it/s]
auc
binary_cross_entropy
auc
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:15<00:07,  1.31it/s]Epoch 20
 60%|█████████████████████████████████████████████████████████████████▍                                           | 18/30 [00:13<00:09,  1.29it/s]Epoch 18
                                                                                                                                                  Loss = 1.7076e-01, PNorm = 34.7417, GNorm = 0.4278, lr_0 = 2.3779e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.7961e-01, PNorm = 34.7636, GNorm = 0.4137, lr_0 = 2.2510e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.93it/s]Validation auc = 0.766789
Validation binary_cross_entropy = 0.288922
 63%|█████████████████████████████████████████████████████████████████████                                        | 19/30 [00:14<00:08,  1.30it/s]Epoch 19
                                                                                                                                                  Loss = 1.8447e-01, PNorm = 34.7859, GNorm = 0.4552, lr_0 = 2.1309e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.75it/s]Validation auc = 0.758242
Validation binary_cross_entropy = 0.279465
 67%|████████████████████████████████████████████████████████████████████████▋                                    | 20/30 [00:15<00:07,  1.31it/s]Epoch 20
                                                                                                                                                  Loss = 1.9216e-01, PNorm = 34.8086, GNorm = 0.3484, lr_0 = 2.0173e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.4796e-01, PNorm = 34.8286, GNorm = 0.7370, lr_0 = 1.9096e-04
 56%|█████████████████████████████████████████████████████████████▉                                                | 9/16 [00:00<00:00, 22.66it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Validation auc = 0.759463
Validation binary_cross_entropy = 0.268561
 70%|████████████████████████████████████████████████████████████████████████████▎                                | 21/30 [00:16<00:06,  1.31it/s]Epoch 21
                                                                                                                                                  Loss = 1.8381e-01, PNorm = 34.8459, GNorm = 1.2939, lr_0 = 1.8078e-04
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 23.75it/s]Loss = 1.6177e-01, PNorm = 34.8750, GNorm = 0.6136, lr_0 = 1.7113e-04
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 22.24it/s]Validation auc = 0.774115
Validation binary_cross_entropy = 0.294373
 73%|███████████████████████████████████████████████████████████████████████████████▉                             | 22/30 [00:17<00:06,  1.30it/s]Epoch 22
                                                                                                                                                  Loss = 1.7049e-01, PNorm = 34.8852, GNorm = 0.5939, lr_0 = 1.6200e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 23.42it/s]Validation auc = 0.771673
Validation binary_cross_entropy = 0.283733
 77%|███████████████████████████████████████████████████████████████████████████████████▌                         | 23/30 [00:17<00:05,  1.30it/s]Epoch 23
                                                                                                                                                  Loss = 1.0690e-01, PNorm = 34.9137, GNorm = 0.4502, lr_0 = 1.5336e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Validation auc = 0.759463
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.56it/s]
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.25it/s]Validation auc = 0.776557
Validation binary_cross_entropy = 0.263482
 80%|███████████████████████████████████████████████████████████████████████████████████████▏                     | 24/30 [00:18<00:04,  1.29it/s]Epoch 24
                                                                                                                                                  Loss = 1.5298e-01, PNorm = 34.9387, GNorm = 0.4663, lr_0 = 1.3743e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.29it/s]Validation auc = 0.789988
Validation binary_cross_entropy = 0.274677
 83%|██████████████████████████████████████████████████████████████████████████████████████████▊                  | 25/30 [00:19<00:04,  1.23it/s]Epoch 25
                                                                                                                                                  Loss = 1.3897e-01, PNorm = 34.9492, GNorm = 0.2052, lr_0 = 1.3010e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]Loss = 1.3111e-01, PNorm = 34.9617, GNorm = 0.9942, lr_0 = 1.2316e-04
 50%|███████████████████████████████████████████████████████                                                       | 8/16 [00:00<00:00, 20.51it/s]
 69%|██████████████████████████████████████████████████████████████████████████▉                                  | 11/16 [00:00<00:00, 21.17it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 23.25it/s]Validation auc = 0.776557
auc
binary_cross_entropy
auc
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.47it/s]Validation auc = 0.775336
Validation binary_cross_entropy = 0.276668
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████           | 27/30 [00:21<00:02,  1.23it/s]Epoch 27
                                                                                                                                                  Loss = 1.4245e-01, PNorm = 35.0006, GNorm = 0.3053, lr_0 = 1.0448e-04
 38%|█████████████████████████████████████████▎                                                                    | 6/16 [00:00<00:00, 22.17it/s]Validation auc = 0.787546
Validation binary_cross_entropy = 0.274436
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 28/30 [00:21<00:01,  1.24it/s]Epoch 28
                                                                                                                                                  Loss = 1.7918e-01, PNorm = 35.0114, GNorm = 0.4782, lr_0 = 1.0000e-04
  0%|                                                                                                                      | 0/16 [00:00<?, ?it/s]
 19%|████████████████████▋                                                                                         | 3/16 [00:00<00:00, 22.24it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████▊                           | 12/16 [00:00<00:00, 21.47it/s]Validation auc = 0.775336
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
Ensemble test auc = 0.855607opy = 0.273166                                                                                                        Validation auc = 0.775336
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:23<00:00,  1.28it/s]
Model 0 best validation auc = 0.789988 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Model 0 test auc = 0.855607
Model 0 test binary_cross_entropy = 0.193339
Ensemble test auc = 0.855607opy = 0.273166                                                                                                        Validation auc = 0.775336
Ensemble test binary_cross_entropy = 0.193339
auc
binary_cross_entropy
auc
binary_cross_entropy
auc
binary_cross_entropy